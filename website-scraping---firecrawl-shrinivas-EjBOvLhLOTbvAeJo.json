{"updatedAt":"2025-11-21T10:27:57.828Z","createdAt":"2025-11-21T07:27:09.852Z","id":"EjBOvLhLOTbvAeJo","name":"Website Scraping - Firecrawl-shrinivas","active":false,"isArchived":false,"nodes":[{"parameters":{},"type":"n8n-nodes-base.manualTrigger","typeVersion":1,"position":[-880,2208],"id":"1e1af6f6-2078-40f8-b165-82bae6944540","name":"When clicking ‘Execute workflow’"},{"parameters":{"operation":"scrape","url":"https://baseballconnected.com/baseball-teams/","parsers":["pdf"],"requestOptions":{}},"type":"@mendable/n8n-nodes-firecrawl.firecrawl","typeVersion":1,"position":[32,48],"id":"f0671430-e59f-4364-b5ea-80ec5181a0fc","name":"Scrape a url and get its content","credentials":{"firecrawlApi":{"id":"Hm7biHGOu4OQpUIC","name":"Firecrawl account"}}},{"parameters":{"promptType":"define","text":"=Read the below markdown and give the Team names and their link from it.\n\n{{ $json.data.markdown }}\n\n\nOutput should be in JSON format As below : \n[\n{\n   \"name\" : \"name_here\",\n   \"url\" : \"url_here\"\n}\n]","hasOutputParser":true,"options":{}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":3,"position":[240,48],"id":"95aa2fde-4f7c-41f4-95f1-d264bfa3db20","name":"AI Agent - Teams List Extractor"},{"parameters":{"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[864,48],"id":"d994f1b3-584d-4a4f-8958-9f5a6b22b1e8","name":"Loop Over Items","alwaysOutputData":false},{"parameters":{"operation":"scrape","url":"={{ $json.url }}","parsers":["pdf"],"requestOptions":{}},"type":"@mendable/n8n-nodes-firecrawl.firecrawl","typeVersion":1,"position":[1184,64],"id":"6e8d0d1e-e00a-4036-9c58-2686635adcd9","name":"Scrape team profile and get details","credentials":{"firecrawlApi":{"id":"Hm7biHGOu4OQpUIC","name":"Firecrawl account"}}},{"parameters":{"jsonSchemaExample":"[\n{\n   \"name\" : \"name_here\",\n   \"url\" : \"url_here\"\n}\n]"},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.3,"position":[416,336],"id":"e1424875-7afd-4b0e-8f2d-f9f3f3bd47e6","name":"Structured Output Parser"},{"parameters":{"jsCode":"return $input.first().json.output"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[608,48],"id":"7c22e77e-67fa-4251-b6bc-59959fb8ee37","name":"Code in JavaScript"},{"parameters":{"promptType":"define","text":"={{ $json.data.markdown }}\n\nread above markdown and return me output in JSON like below\n\n{\n\"team_name\" : \"team_name_here\",\n\"website\" : \"website\",\n\"description\" : \"description\",\n\"firstname\" : \"firstname\",\n\"lastname\" : \"lastname\",\n\"email\" : \"emailaddress\",\n\"contact\" : \"contact number\",\n\"location\" :\"location\",\n\"facebook\" : \"facebook page url\",\n\"instagram\" : \"instagram url\",\n\"twitter\" : \"twitter url\"\n}","hasOutputParser":true,"options":{}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":3,"position":[1408,64],"id":"43085f3e-3c37-4025-9029-415ae4225018","name":"AI Agent - Get team details"},{"parameters":{"jsonSchemaExample":"{\n\"team_name\" : \"team_name_here\",\n\"website\" : \"website\",\n\"description\" : \"description\",\n\"firstname\" : \"firstname\",\n\"lastname\" : \"lastname\",\n\"email\" : \"emailaddress\",\n\"contact\" : \"contact number\",\n\"location\" :\"location\",\n\"facebook\" : \"facebook page url\",\n\"instagram\" : \"instagram url\",\n\"twitter\" : \"twitter url\"\n}","autoFix":true},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.3,"position":[1472,304],"id":"055f0676-74d1-4f33-a42e-8871aff5f913","name":"Output Helper"},{"parameters":{"operation":"append","documentId":{"__rl":true,"value":"101Y3Pl-yh7h4ArxLNh9DH-1e4IUsWKg9xskkmaPh-4I","mode":"list","cachedResultName":"Data-scraping-apify","cachedResultUrl":"https://docs.google.com/spreadsheets/d/101Y3Pl-yh7h4ArxLNh9DH-1e4IUsWKg9xskkmaPh-4I/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":1247602635,"mode":"list","cachedResultName":"Sheet4","cachedResultUrl":"https://docs.google.com/spreadsheets/d/101Y3Pl-yh7h4ArxLNh9DH-1e4IUsWKg9xskkmaPh-4I/edit#gid=1247602635"},"columns":{"mappingMode":"defineBelow","value":{"Team Name":"={{ $json.output.team_name }}","Website":"={{ $json.output.website }}","Contact":"={{ $json.output.contact }}","Lastname":"={{ $json.output.lastname }}","Firstname":"={{ $json.output.firstname }}","Email":"={{ $json.output.email }}","Facebook":"={{ $json.output.facebook }}","Instagram":"={{ $json.output.instagram }}","Twitter":"={{ $json.output.twitter }}","Description":"={{ $json.output.description }}","Location":"={{ $json.output.location }}"},"matchingColumns":[],"schema":[{"id":"Team Name","displayName":"Team Name","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Firstname","displayName":"Firstname","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Lastname","displayName":"Lastname","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Email","displayName":"Email","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Contact","displayName":"Contact","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Location","displayName":"Location","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"Website","displayName":"Website","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Facebook","displayName":"Facebook","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Instagram","displayName":"Instagram","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Twitter","displayName":"Twitter","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Description","displayName":"Description","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.googleSheets","typeVersion":4.7,"position":[2016,368],"id":"aca6e5b6-b4b3-4871-8926-bf0019b88a9a","name":"Append row in sheet","credentials":{"googleSheetsOAuth2Api":{"id":"Rb8zubR3AtNAnBYU","name":"Google Sheets account 3"}}},{"parameters":{"modelName":"models/gemini-2.0-flash","options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatGoogleGemini","typeVersion":1,"position":[240,336],"id":"521d4842-824d-4e28-b412-3dc4b2e1232e","name":"Google Gemini Chat Model","credentials":{"googlePalmApi":{"id":"2dYCQEJmlRAbJ0ZK","name":"edwin-gemini-api-key"}}},{"parameters":{"modelName":"models/gemini-2.0-flash","options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatGoogleGemini","typeVersion":1,"position":[1280,336],"id":"020d1581-8754-4210-9694-e55663e21bbf","name":"Google Gemini Chat Model1","credentials":{"googlePalmApi":{"id":"2dYCQEJmlRAbJ0ZK","name":"edwin-gemini-api-key"}}},{"parameters":{"modelName":"models/gemini-2.0-flash","options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatGoogleGemini","typeVersion":1,"position":[1472,416],"id":"a778b9be-7ba1-4468-8330-276a861a0a3d","name":"Google Gemini Chat Model2","credentials":{"googlePalmApi":{"id":"2dYCQEJmlRAbJ0ZK","name":"edwin-gemini-api-key"}}},{"parameters":{"jsCode":"// n8n Code node\n// Expects the first input item to contain .json.data.markdown from your initial Scrape node\n\nconst input = $input.all();\nif (!input.length) return [];\n\nconst markdown = (input[0].json && input[0].json.data && input[0].json.data.markdown) ? input[0].json.data.markdown : '';\nconst root = 'https://baseballconnected.com';\nconst listPathCandidates = [\n  '/baseball-teams',\n  '/baseball-teams/'\n];\n\n// Helper to make absolute url\nfunction absolutize(u) {\n  if (!u) return null;\n  u = u.trim();\n  if (u.startsWith('//')) return 'https:' + u;\n  if (u.startsWith('http://') || u.startsWith('https://')) return u.split('#')[0];\n  if (u.startsWith('/')) return root + u.split('#')[0];\n  // relative path without leading slash -> join to root\n  return root + '/' + u.split('#')[0];\n}\n\n// 1) Try to extract explicit pagination links (e.g., href=\"/baseball-teams/page/2/\" or ?page=2)\nconst explicitLinkRegex = /href=(?:'|\")([^'\"]*?(?:page[=_\\/-]?\\d+|[?&](?:page|paged)=\\d+)[^'\"]*?)(?:'|\")/gi;\nlet m;\nconst urlsSet = new Set();\nwhile ((m = explicitLinkRegex.exec(markdown)) !== null) {\n  const candidate = absolutize(m[1]);\n  if (candidate) urlsSet.add(candidate);\n}\n\n// 2) Also try to capture numeric pagination links anywhere (e.g., <a>2</a> in a pagination block)\nif (urlsSet.size === 0) {\n  // Try to extract common pagination blocks (nav, ul.pagination, div.pagination)\n  const paginationBlockMatch = markdown.match(/(<(nav|ul|div)[^>]*?(pagination|page|pager)[^>]*>[\\s\\S]*?<\\/\\2>)/i);\n  if (paginationBlockMatch) {\n    const block = paginationBlockMatch[0];\n    const numLinkRegex = /href=(?:'|\")([^'\"]*?)['\"][^>]*>\\s*(\\d+)\\s*<\\/a>/gi;\n    while ((m = numLinkRegex.exec(block)) !== null) {\n      const candidate = absolutize(m[1]);\n      if (candidate) urlsSet.add(candidate);\n    }\n  }\n}\n\n// 3) If still none, try to detect highest page number and build URLs using common patterns\nlet maxPage = 1;\nif (urlsSet.size === 0) {\n  // common patterns: /page/NUM, ?page=NUM, ?paged=NUM, page=NUM\n  const pageNumRegex = /(?:\\/page\\/|[?&](?:page|paged)=)(\\d+)/gi;\n  while ((m = pageNumRegex.exec(markdown)) !== null) {\n    const n = parseInt(m[1], 10);\n    if (!isNaN(n) && n > maxPage) maxPage = n;\n  }\n\n  // fallback: search for visible page numbers in pagination block text\n  if (maxPage === 1) {\n    const allNums = [...markdown.matchAll(/>\\s*(\\d+)\\s*<\\/a>/g)].map(x => parseInt(x[1],10)).filter(Boolean);\n    if (allNums.length) maxPage = Math.max(...allNums);\n  }\n\n  // If we found maxPage > 1, build URLs with the two common patterns and prefer the /page/N/ format\n  if (maxPage > 1) {\n    // choose base path from candidate list that appears in markdown, else default\n    let base = listPathCandidates.find(p => markdown.includes(p)) || '/baseball-teams';\n    // create exact URLs for /page/N/ pattern\n    for (let p = 1; p <= maxPage; p++) {\n      // Note: include page 1 to keep consistency\n      const url = `${root}${base.replace(/\\/$/, '')}/page/${p}/`;\n      urlsSet.add(url);\n    }\n  }\n}\n\n// 4) Final fallback: just return the single main list page\nif (urlsSet.size === 0) {\n  urlsSet.add('https://baseballconnected.com/baseball-teams/');\n}\n\n// 5) Normalize duplicates and return as n8n items\nconst results = Array.from(urlsSet).map(u => ({ json: { url: u } }));\n\n// Optional: sort by URL natural order (so page1, page2, ...)\nresults.sort((a,b) => a.json.url.localeCompare(b.json.url, undefined, { numeric: true }));\n\nreturn results;\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[608,-64],"id":"6e15750f-35b4-473b-9481-29f84c526a14","name":"Code in JavaScript1"},{"parameters":{"jsCode":"// n8n Code node: Pagination detector for client-side (JS/AJAX) pagination\n// Input: first item should contain .json.data.markdown from the initial scrape\nconst input = $input.all();\nif (!input.length) return [];\n\nconst markdown = (input[0].json && input[0].json.data && input[0].json.data.markdown) ? input[0].json.data.markdown : '';\nconst root = 'https://baseballconnected.com';\nconst listPath = '/baseball-teams'; // base path used to construct candidate urls\nconst results = [];\nconst seen = new Set();\n\nfunction make(u) {\n  if (!u) return null;\n  u = u.trim();\n  // normalize some common patterns\n  if (u.startsWith('//')) u = 'https:' + u;\n  if (u.startsWith('/')) u = 'https://baseballconnected.com' + u;\n  if (!/^https?:\\/\\//i.test(u)) {\n    // relative or query-only\n    if (u.startsWith('?') || u.startsWith('#')) return 'https://baseballconnected.com' + listPath + u;\n    return 'https://baseballconnected.com' + (u.startsWith('/') ? u : ('/' + u));\n  }\n  return u.split('#')[0];\n}\n\n// 1) direct href links containing page patterns\nconst hrefRegex = /href=(?:'|\")([^'\"]*?(?:\\/page\\/\\d+|[?&](?:page|paged)=\\d+|page[=_-]?\\d+)[^'\"]*?)(?:'|\")/gi;\nlet m;\nwhile ((m = hrefRegex.exec(markdown)) !== null) {\n  const url = make(m[1]);\n  if (url && !seen.has(url)) { seen.add(url); results.push({ json: { url, detectionType: 'link' } }); }\n}\n\n// 2) anchors/buttons with data-page attributes: <a data-page=\"2\"> or <button data-page=\"3\">\nif (results.length === 0) {\n  const dataPageRegex = /(?:data-page|data-paged|data-pagination)=[\"']?(\\d+)[\"']?/gi;\n  const pagesFound = new Set();\n  while ((m = dataPageRegex.exec(markdown)) !== null) {\n    const n = parseInt(m[1], 10);\n    if (!isNaN(n)) pagesFound.add(n);\n  }\n  if (pagesFound.size) {\n    const max = Math.max(...Array.from(pagesFound));\n    for (let p = 1; p <= max; p++) {\n      // create candidate URLs; some sites accept ?page= or /page/\n      const u1 = `https://baseballconnected.com${listPath}/?page=${p}`;\n      const u2 = `https://baseballconnected.com${listPath}/page/${p}/`;\n      if (!seen.has(u1)) { seen.add(u1); results.push({ json: { url: u1, detectionType: 'data-attr' } }); }\n      if (!seen.has(u2)) { seen.add(u2); results.push({ json: { url: u2, detectionType: 'data-attr' } }); }\n    }\n  }\n}\n\n// 3) onclick handlers like onclick=\"loadPage(3)\" or onclick=\"goToPage(2)\"\nif (results.length === 0) {\n  const onclickRegex = /onclick=[\"'][^\"']*(?:page|paged|goto|goTo|loadPage)\\D*(\\d+)[^\"']*[\"']/gi;\n  const pageNums = new Set();\n  while ((m = onclickRegex.exec(markdown)) !== null) {\n    const n = parseInt(m[1],10);\n    if (!isNaN(n)) pageNums.add(n);\n  }\n  if (pageNums.size) {\n    const max = Math.max(...Array.from(pageNums));\n    for (let p = 1; p <= max; p++) {\n      const u = `https://baseballconnected.com${listPath}/page/${p}/`;\n      if (!seen.has(u)) { seen.add(u); results.push({ json: { url: u, detectionType: 'onclick' } }); }\n    }\n  }\n}\n\n// 4) try to find XHR / API endpoints referenced in inline scripts (wp-json, fetch('/…'), axios.get('/…'))\nif (results.length === 0) {\n  const xhrRegex = /(\\/wp-json\\/[^\\s'\"]+|fetch\\(['\"]([^'\"]+)['\"]\\)|axios\\.get\\(['\"]([^'\"]+)['\"]\\))/gi;\n  while ((m = xhrRegex.exec(markdown)) !== null) {\n    const candidate = m[1] || m[2] || m[3];\n    if (!candidate) continue;\n    let url = candidate;\n    // if relative, absolutize\n    if (url.startsWith('/')) url = 'https://baseballconnected.com' + url;\n    if (!/^https?:\\/\\//i.test(url) && url.startsWith('http') === false) continue;\n    if (!seen.has(url)) { seen.add(url); results.push({ json: { url, detectionType: 'xhr' } }); }\n  }\n}\n\n// 5) last resort: if no markers found, return the single page but mark as 'client-side'\nif (results.length === 0) {\n  // return the main page but with note\n  const u = 'https://baseballconnected.com/baseball-teams/';\n  results.push({ json: { url: u, detectionType: 'client-side-only' } });\n}\n\n// sort by numeric page if possible (helps order)\nresults.sort((a,b) => {\n  const pa = (a.json.url.match(/(\\d+)(?=\\/?$)/) || [null])[0] || '';\n  const pb = (b.json.url.match(/(\\d+)(?=\\/?$)/) || [null])[0] || '';\n  if (pa && pb) return parseInt(pa) - parseInt(pb);\n  return a.json.url.localeCompare(b.json.url, undefined, { numeric: true });\n});\n\nreturn results;\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[1408,960],"id":"218a183c-4cbc-4599-8908-548e3deb5fe2","name":"Pagination Code (generate page URLs)"},{"parameters":{"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[1616,960],"id":"9d9cb54b-e270-4d2b-8a9c-cd2463f47d66","name":"Split Pages (loop pages)","alwaysOutputData":false},{"parameters":{"operation":"scrape","url":"={{ $json.url }}","parsers":["pdf"],"requestOptions":{}},"type":"@mendable/n8n-nodes-firecrawl.firecrawl","typeVersion":1,"position":[1888,944],"id":"59878140-72b8-4955-b393-d3e569ddf087","name":"Scrape list page and get content","credentials":{"firecrawlApi":{"id":"Hm7biHGOu4OQpUIC","name":"Firecrawl account"}}},{"parameters":{"operation":"scrape","url":"https://baseballconnected.com/baseball-teams/","additionalFields":{"customProperties":"{\n  \"actions\": [\n    { \"type\": \"click\", \"selector\": \".next-button\" },\n    { \"type\": \"wait\", \"milliseconds\": 1000 }\n  ]\n}"},"useCustomBody":true,"requestOptions":{}},"type":"@mendable/n8n-nodes-firecrawl.firecrawl","typeVersion":1,"position":[2368,336],"id":"f2d49eb1-c94b-4410-8775-4efc0f76d646","name":"Scrape a url and get its content1","credentials":{"firecrawlApi":{"id":"Hm7biHGOu4OQpUIC","name":"Firecrawl account"}}},{"parameters":{"promptType":"define","text":"=Read the below markdown and give the Team names and their link from it.\n\n{{ $json.data.markdown }}\n\n\nOutput should be in JSON format As below : \n[\n{\n   \"name\" : \"name_here\",\n   \"url\" : \"url_here\"\n}\n]","hasOutputParser":true,"options":{}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":3,"position":[2096,960],"id":"860efeda-d64f-4827-8305-09180043bca0","name":"AI Agent - Teams List Extractor1"},{"parameters":{"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[2704,992],"id":"410803f5-5802-40b0-bb6e-cff8ed6a6948","name":"Loop Over Items1","alwaysOutputData":false},{"parameters":{"operation":"scrape","url":"={{ $json.url }}","parsers":["pdf"],"requestOptions":{}},"type":"@mendable/n8n-nodes-firecrawl.firecrawl","typeVersion":1,"position":[3008,736],"id":"044ed69a-051c-4bff-ba26-61e8d6b88974","name":"Scrape team profile and get details1","credentials":{"firecrawlApi":{"id":"Hm7biHGOu4OQpUIC","name":"Firecrawl account"}}},{"parameters":{"jsonSchemaExample":"[\n{\n   \"name\" : \"name_here\",\n   \"url\" : \"url_here\"\n}\n]"},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.3,"position":[2240,1168],"id":"713ecbcd-b157-42c6-b24e-1d4f630c1103","name":"Structured Output Parser1"},{"parameters":{"jsCode":"return $input.first().json.output"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[2448,992],"id":"c47010b1-bfc8-4594-a3aa-612c9039582b","name":"Code in JavaScript2"},{"parameters":{"promptType":"define","text":"={{ $json.data.markdown }}\n\nread above markdown and return me output in JSON like below\n\n{\n\"team_name\" : \"team_name_here\",\n\"website\" : \"website\",\n\"description\" : \"description\",\n\"firstname\" : \"firstname\",\n\"lastname\" : \"lastname\",\n\"email\" : \"emailaddress\",\n\"contact\" : \"contact number\",\n\"location\" :\"location\",\n\"facebook\" : \"facebook page url\",\n\"instagram\" : \"instagram url\",\n\"twitter\" : \"twitter url\"\n}","hasOutputParser":true,"options":{}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":3,"position":[3248,688],"id":"3c2fb557-d529-41eb-a38a-a0a1c55fdc4a","name":"AI Agent - Get team details1"},{"parameters":{"jsonSchemaExample":"{\n\"team_name\" : \"team_name_here\",\n\"website\" : \"website\",\n\"description\" : \"description\",\n\"firstname\" : \"firstname\",\n\"lastname\" : \"lastname\",\n\"email\" : \"emailaddress\",\n\"contact\" : \"contact number\",\n\"location\" :\"location\",\n\"facebook\" : \"facebook page url\",\n\"instagram\" : \"instagram url\",\n\"twitter\" : \"twitter url\"\n}","autoFix":true},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.3,"position":[3312,928],"id":"ecbc1f22-bdec-4872-b2e4-b5d55452c50e","name":"Output Helper1"},{"parameters":{"operation":"append","documentId":{"__rl":true,"value":"101Y3Pl-yh7h4ArxLNh9DH-1e4IUsWKg9xskkmaPh-4I","mode":"list","cachedResultName":"Data-scraping-apify","cachedResultUrl":"https://docs.google.com/spreadsheets/d/101Y3Pl-yh7h4ArxLNh9DH-1e4IUsWKg9xskkmaPh-4I/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":1247602635,"mode":"list","cachedResultName":"Sheet4","cachedResultUrl":"https://docs.google.com/spreadsheets/d/101Y3Pl-yh7h4ArxLNh9DH-1e4IUsWKg9xskkmaPh-4I/edit#gid=1247602635"},"columns":{"mappingMode":"defineBelow","value":{"Team Name":"={{ $json.output.team_name }}","Website":"={{ $json.output.website }}","Contact":"={{ $json.output.contact }}","Lastname":"={{ $json.output.lastname }}","Firstname":"={{ $json.output.firstname }}","Email":"={{ $json.output.email }}","Facebook":"={{ $json.output.facebook }}","Instagram":"={{ $json.output.instagram }}","Twitter":"={{ $json.output.twitter }}","Description":"={{ $json.output.description }}","Location":"={{ $json.output.location }}"},"matchingColumns":[],"schema":[{"id":"Team Name","displayName":"Team Name","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Firstname","displayName":"Firstname","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Lastname","displayName":"Lastname","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Email","displayName":"Email","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Contact","displayName":"Contact","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Location","displayName":"Location","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"Website","displayName":"Website","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Facebook","displayName":"Facebook","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Instagram","displayName":"Instagram","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Twitter","displayName":"Twitter","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Description","displayName":"Description","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.googleSheets","typeVersion":4.7,"position":[3856,992],"id":"2f60757e-e861-486d-a586-06e7590c7c9d","name":"Append row in sheet1","credentials":{"googleSheetsOAuth2Api":{"id":"Rb8zubR3AtNAnBYU","name":"Google Sheets account 3"}}},{"parameters":{"modelName":"models/gemini-2.0-flash","options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatGoogleGemini","typeVersion":1,"position":[2096,1168],"id":"67f2c69a-81f8-4c3c-b3c9-79add5bc64e4","name":"Google Gemini Chat Model3","credentials":{"googlePalmApi":{"id":"2dYCQEJmlRAbJ0ZK","name":"edwin-gemini-api-key"}}},{"parameters":{"modelName":"models/gemini-2.0-flash","options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatGoogleGemini","typeVersion":1,"position":[3120,960],"id":"a23f590b-7d8e-4259-bef6-065c94bd1859","name":"Google Gemini Chat Model4","credentials":{"googlePalmApi":{"id":"2dYCQEJmlRAbJ0ZK","name":"edwin-gemini-api-key"}}},{"parameters":{"modelName":"models/gemini-2.0-flash","options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatGoogleGemini","typeVersion":1,"position":[3312,1056],"id":"6a211207-5d8a-435a-aadf-e004b7a8566f","name":"Google Gemini Chat Model5","credentials":{"googlePalmApi":{"id":"2dYCQEJmlRAbJ0ZK","name":"edwin-gemini-api-key"}}},{"parameters":{"operation":"scrape","url":"https://baseballconnected.com/baseball-teams/","parsers":["pdf"],"requestOptions":{}},"type":"@mendable/n8n-nodes-firecrawl.firecrawl","typeVersion":1,"position":[3136,-128],"id":"87d30149-3f34-40bb-93ff-a5090c9ab6bc","name":"Scrape a url and get its content2","credentials":{"firecrawlApi":{"id":"Hm7biHGOu4OQpUIC","name":"Firecrawl account"}}},{"parameters":{"jsCode":"const input = $input.all();\nif (!input.length) return [];\n\nconst markdown = (input[0].json && input[0].json.data && input[0].json.data.markdown) ? input[0].json.data.markdown : '';\nconst root = 'https://baseballconnected.com';\nconst listPathCandidates = [\n  '/baseball-teams',\n  '/baseball-teams/'\n];\n\n// Helper to make absolute url\nfunction absolutize(u) {\n  if (!u) return null;\n  u = u.trim();\n  if (u.startsWith('//')) return 'https:' + u;\n  if (u.startsWith('http://') || u.startsWith('https://')) return u.split('#')[0];\n  if (u.startsWith('/')) return root + u.split('#')[0];\n  return root + '/' + u.split('#')[0];\n}\n\n// 1) Try to extract explicit pagination links (e.g., href=\"/baseball-teams/page/2/\" or ?page=2)\nconst explicitLinkRegex = /href=(?:'|\")([^'\"]*?(?:page[=_\\/\\-]?\\d+|[?&](?:page|paged)=\\d+)[^'\"]*?)(?:'|\")/gi;\nlet m;\nconst urlsSet = new Set();\nwhile ((m = explicitLinkRegex.exec(markdown)) !== null) {\n  const candidate = absolutize(m[1]);\n  if (candidate) urlsSet.add(candidate);\n}\n\n// 2) Also try to capture numeric pagination links anywhere (e.g., <a>2</a> in a pagination block)\nif (urlsSet.size === 0) {\n  const paginationBlockMatch = markdown.match(/(<(nav|ul|div)[^>]*?(pagination|page|pager)[^>]*>[\\s\\S]*?<\\/\\2>)/i);\n  if (paginationBlockMatch) {\n    const block = paginationBlockMatch[0];\n    const numLinkRegex = /href=(?:'|\")([^'\"]*?)['\"][^>]*>\\s*(\\d+)\\s*<\\/a>/gi;\n    while ((m = numLinkRegex.exec(block)) !== null) {\n      const candidate = absolutize(m[1]);\n      if (candidate) urlsSet.add(candidate);\n    }\n  }\n}\n\n// 3) If still none, try to detect highest page number and build URLs using common patterns\nlet maxPage = 1;\nif (urlsSet.size === 0) {\n  const pageNumRegex = /(?:\\/page\\/|[?&](?:page|paged)=)(\\d+)/gi;\n  while ((m = pageNumRegex.exec(markdown)) !== null) {\n    const n = parseInt(m[1], 10);\n    if (!isNaN(n) && n > maxPage) maxPage = n;\n  }\n\n  if (maxPage === 1) {\n    const allNums = [...markdown.matchAll(/>\\s*(\\d+)\\s*<\\/a>/g)].map(x => parseInt(x[1],10)).filter(Boolean);\n    if (allNums.length) maxPage = Math.max(...allNums);\n  }\n\n  if (maxPage > 1) {\n    let base = listPathCandidates.find(p => markdown.includes(p)) || '/baseball-teams';\n    for (let p = 1; p <= maxPage; p++) {\n      const url = `${root}${base.replace(/\\/$/, '')}/page/${p}/`;\n      urlsSet.add(url);\n    }\n  }\n}\n\n// 4) Final fallback: just return the single main list page\nif (urlsSet.size === 0) {\n  urlsSet.add('https://baseballconnected.com/baseball-teams/');\n}\n\nconst results = Array.from(urlsSet).map(u => ({ json: { url: u } }));\nresults.sort((a,b) => a.json.url.localeCompare(b.json.url, undefined, { numeric: true }));\nreturn results;\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[3376,-208],"id":"bcc0d919-73ad-4aaf-86e1-180a5d401859","name":"Pagination Code (generate page URLs)1"},{"parameters":{"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[3552,-256],"id":"09921dc2-dc4d-4d4b-a8cc-a7b04e518382","name":"Split Pages (loop pages)1","alwaysOutputData":false},{"parameters":{"operation":"scrape","url":"={{ $json.url }}","parsers":["pdf"],"requestOptions":{}},"type":"@mendable/n8n-nodes-firecrawl.firecrawl","typeVersion":1,"position":[3776,-32],"id":"177205c7-57b7-416e-b0b9-1d69c04a79c2","name":"Scrape list page and get content1","credentials":{"firecrawlApi":{"id":"Hm7biHGOu4OQpUIC","name":"Firecrawl account"}}},{"parameters":{"promptType":"define","text":"=Read the below markdown and give the Team names and their link from it.\n\n{{ $json.data.markdown }}\n\n\nOutput should be in JSON format As below : \n[\n{\n   \"name\" : \"name_here\",\n   \"url\" : \"url_here\"\n}\n]","hasOutputParser":true,"options":{}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":3,"position":[3968,-48],"id":"1f413ee9-4bd2-4153-b512-e7d26d8452fe","name":"AI Agent - Teams List Extractor2"},{"parameters":{"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[3936,288],"id":"7c18f7fd-df68-4592-9f56-3b32c30821bb","name":"Loop Over Items2","alwaysOutputData":false},{"parameters":{"operation":"scrape","url":"={{ $json.url }}","parsers":["pdf"],"requestOptions":{}},"type":"@mendable/n8n-nodes-firecrawl.firecrawl","typeVersion":1,"position":[4288,-112],"id":"a9ad7903-02c9-4117-a3cb-475213864e41","name":"Scrape team profile and get details2","credentials":{"firecrawlApi":{"id":"Hm7biHGOu4OQpUIC","name":"Firecrawl account"}}},{"parameters":{"jsonSchemaExample":"[\n{\n   \"name\" : \"name_here\",\n   \"url\" : \"url_here\"\n}\n]"},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.3,"position":[3520,160],"id":"10bb750f-4e92-4360-b9dd-d4f57bd811d7","name":"Structured Output Parser2"},{"parameters":{"jsCode":"return $input.first().json.output"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[3712,352],"id":"6790a6b9-459d-44b8-bde8-1c210c915dff","name":"Code in JavaScript3"},{"parameters":{"promptType":"define","text":"={{ $json.data.markdown }}\n\nread above markdown and return me output in JSON like below\n\n{\n\"team_name\" : \"team_name_here\",\n\"website\" : \"website\",\n\"description\" : \"description\",\n\"firstname\" : \"firstname,\n\"lastname\" : \"lastname\",\n\"email\" : \"emailaddress\",\n\"contact\" : \"contact number\",\n\"location\" :\"location\",\n\"facebook\" : \"facebook page url\",\n\"instagram\" : \"instagram url\",\n\"twitter\" : \"twitter url\"\n}","hasOutputParser":true,"options":{}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":3,"position":[4512,-112],"id":"54dc0c0c-3f6a-49e5-a936-95e504fd67ff","name":"AI Agent - Get team details2"},{"parameters":{"jsonSchemaExample":"{\n\"team_name\" : \"team_name_here\",\n\"website\" : \"website\",\n\"description\" : \"description\",\n\"firstname\" : \"firstname\",\n\"lastname\" : \"lastname\",\n\"email\" : \"emailaddress\",\n\"contact\" : \"contact number\",\n\"location\" :\"location\",\n\"facebook\" : \"facebook page url\",\n\"instagram\" : \"instagram url\",\n\"twitter\" : \"twitter url\"\n}","autoFix":true},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.3,"position":[4576,128],"id":"26a48d72-4ecf-463b-bb0b-c5960fe5a9f0","name":"Output Helper2"},{"parameters":{"operation":"append","documentId":{"__rl":true,"value":"101Y3Pl-yh7h4ArxLNh9DH-1e4IUsWKg9xskkmaPh-4I","mode":"list","cachedResultName":"Data-scraping-apify","cachedResultUrl":"https://docs.google.com/spreadsheets/d/101Y3Pl-yh7h4ArxLNh9DH-1e4IUsWKg9xskkmaPh-4I/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":1247602635,"mode":"list","cachedResultName":"Sheet4","cachedResultUrl":"https://docs.google.com/spreadsheets/d/101Y3Pl-yh7h4ArxLNh9DH-1e4IUsWKg9xskkmaPh-4I/edit#gid=1247602635"},"columns":{"mappingMode":"defineBelow","value":{"Team Name":"={{ $json.output.team_name }}","Website":"={{ $json.output.website }}","Contact":"={{ $json.output.contact }}","Lastname":"={{ $json.output.lastname }}","Firstname":"={{ $json.output.firstname }}","Email":"={{ $json.output.email }}","Facebook":"={{ $json.output.facebook }}","Instagram":"={{ $json.output.instagram }}","Twitter":"={{ $json.output.twitter }}","Description":"={{ $json.output.description }}","Location":"={{ $json.output.location }}"},"matchingColumns":[],"schema":[{"id":"Team Name","displayName":"Team Name","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Firstname","displayName":"Firstname","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Lastname","displayName":"Lastname","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Email","displayName":"Email","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Contact","displayName":"Contact","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Location","displayName":"Location","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"Website","displayName":"Website","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Facebook","displayName":"Facebook","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Instagram","displayName":"Instagram","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Twitter","displayName":"Twitter","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Description","displayName":"Description","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.googleSheets","typeVersion":4.7,"position":[5120,192],"id":"d49a3ce9-0096-45f1-9ae9-946fc07deb56","name":"Append row in sheet2","credentials":{"googleSheetsOAuth2Api":{"id":"Rb8zubR3AtNAnBYU","name":"Google Sheets account 3"}}},{"parameters":{"modelName":"models/gemini-2.0-flash","options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatGoogleGemini","typeVersion":1,"position":[3344,160],"id":"bd2132f7-eae7-410e-8aef-6804292dac28","name":"Google Gemini Chat Model6","credentials":{"googlePalmApi":{"id":"2dYCQEJmlRAbJ0ZK","name":"edwin-gemini-api-key"}}},{"parameters":{"modelName":"models/gemini-2.0-flash","options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatGoogleGemini","typeVersion":1,"position":[4384,160],"id":"8c8b0a06-43fd-43b5-a47d-0b7fe3748cf1","name":"Google Gemini Chat Model7","credentials":{"googlePalmApi":{"id":"2dYCQEJmlRAbJ0ZK","name":"edwin-gemini-api-key"}}},{"parameters":{"modelName":"models/gemini-2.0-flash","options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatGoogleGemini","typeVersion":1,"position":[4576,240],"id":"7d9367cc-4d9f-49b8-a172-df9ba6c33b2b","name":"Google Gemini Chat Model8","credentials":{"googlePalmApi":{"id":"2dYCQEJmlRAbJ0ZK","name":"edwin-gemini-api-key"}}},{"parameters":{"operation":"crawl","url":"https://baseballconnected.com/baseball-teams/","limit":20,"crawlOptions":{},"requestOptions":{}},"type":"@mendable/n8n-nodes-firecrawl.firecrawl","typeVersion":1,"position":[1184,976],"id":"6fdadfe5-2c76-41f9-9172-62d4ff588064","name":"Crawl Baseball Teams Pages","credentials":{"firecrawlApi":{"id":"Hm7biHGOu4OQpUIC","name":"Firecrawl account"}}},{"parameters":{"operation":"scrape","url":"https://baseballconnected.com/baseball-teams/","parsers":["pdf"],"scrapeOptions":{"options":{"onlyMainContent":false,"headers":{},"waitFor":7000,"actions":{"items":[{"milliseconds":7000}]}}},"requestOptions":{}},"type":"@mendable/n8n-nodes-firecrawl.firecrawl","typeVersion":1,"position":[-576,2192],"id":"da65c44e-7cea-4c4a-8054-cf92794f31c0","name":"Initial Scrape - Get First Page","credentials":{"firecrawlApi":{"id":"Hm7biHGOu4OQpUIC","name":"Firecrawl account"}}},{"parameters":{"jsCode":"// Enhanced pagination URL generator for Baseball Connected\nconst input = $input.all();\nif (!input.length) return [];\n\nconst markdown = (input[0].json && input[0].json.data && input[0].json.data.markdown) ? input[0].json.data.markdown : '';\nconst baseUrl = 'https://baseballconnected.com/baseball-teams';\nconst results = [];\nconst seen = new Set();\n\n// Add the first page\nresults.push({ json: { url: baseUrl + '/', pageNumber: 1, detectionType: 'base' } });\nseen.add(baseUrl + '/');\n\n// Method 1: Look for WordPress-style pagination patterns\nconst wpPageRegex = /href=[\"']([^\"']*\\/page\\/\\d+\\/?)[\"']/gi;\nlet match;\nwhile ((match = wpPageRegex.exec(markdown)) !== null) {\n  let url = match[1];\n  if (url.startsWith('/')) url = 'https://baseballconnected.com' + url;\n  if (!url.startsWith('http')) url = 'https://baseballconnected.com/' + url;\n  const pageNum = (url.match(/\\/page\\/(\\d+)/) || [])[1];\n  if (!seen.has(url)) {\n    seen.add(url);\n    results.push({ json: { url, pageNumber: parseInt(pageNum) || 0, detectionType: 'wp-pagination' } });\n  }\n}\n\n// Method 2: Look for query string pagination\nconst queryPageRegex = /href=[\"']([^\"']*[?&](?:page|paged)=(\\d+)[^\"']*)[\"']/gi;\nwhile ((match = queryPageRegex.exec(markdown)) !== null) {\n  let url = match[1];\n  const pageNum = match[2];\n  if (url.startsWith('/')) url = 'https://baseballconnected.com' + url;\n  if (!url.startsWith('http')) url = 'https://baseballconnected.com/' + url;\n  if (!seen.has(url)) {\n    seen.add(url);\n    results.push({ json: { url, pageNumber: parseInt(pageNum) || 0, detectionType: 'query-pagination' } });\n  }\n}\n\n// Method 3: Look for data attributes indicating pages\nconst dataPageRegex = /data-page=[\"']?(\\d+)[\"']?/gi;\nconst pageNumbers = new Set();\nwhile ((match = dataPageRegex.exec(markdown)) !== null) {\n  pageNumbers.add(parseInt(match[1]));\n}\n\n// Method 4: Look for numbered links in pagination (1, 2, 3, etc.)\nconst numLinkRegex = /<a[^>]*class=[\"'][^\"']*(?:page-numbers|pagination)[^\"']*[\"'][^>]*>(\\d+)<\\/a>/gi;\nwhile ((match = numLinkRegex.exec(markdown)) !== null) {\n  pageNumbers.add(parseInt(match[1]));\n}\n\n// If we found page numbers via data attributes or numbered links, generate URLs\nif (pageNumbers.size > 0) {\n  const maxPage = Math.max(...Array.from(pageNumbers));\n  // Generate URLs for pages 2 through maxPage\n  for (let i = 2; i <= maxPage; i++) {\n    // Try WordPress-style first\n    const wpUrl = `${baseUrl}/page/${i}/`;\n    if (!seen.has(wpUrl)) {\n      seen.add(wpUrl);\n      results.push({ json: { url: wpUrl, pageNumber: i, detectionType: 'generated-wp' } });\n    }\n    \n    // Also try query string style as backup\n    const queryUrl = `${baseUrl}/?page=${i}`;\n    if (!seen.has(queryUrl)) {\n      seen.add(queryUrl);\n      results.push({ json: { url: queryUrl, pageNumber: i, detectionType: 'generated-query' } });\n    }\n  }\n}\n\n// Fallback: If no pagination detected, try common page counts\nif (results.length === 1) {\n  // Generate URLs for first 10 pages as fallback\n  for (let i = 2; i <= 10; i++) {\n    const wpUrl = `${baseUrl}/page/${i}/`;\n    results.push({ json: { url: wpUrl, pageNumber: i, detectionType: 'fallback' } });\n  }\n}\n\n// Sort by page number\nresults.sort((a, b) => a.json.pageNumber - b.json.pageNumber);\n\n// Log info for debugging\nconsole.log(`Generated ${results.length} page URLs`);\n\nreturn results;"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-240,2240],"id":"35c97f43-607d-4d68-bc7e-6e57b58b16ab","name":"Generate Page URLs"},{"parameters":{"jsCode":"return $input.first().json.output"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[800,2272],"id":"681cc8e7-34f7-4a95-a419-fae13bf68c22","name":"Extract Teams Array"},{"parameters":{"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[-32,2240],"id":"7d8bad04-9dcb-4e79-94bf-5fd8d157e0fa","name":"Split Pages (loop pages)2","alwaysOutputData":false},{"parameters":{"operation":"scrape","url":"={{ $json.url }}","requestOptions":{}},"type":"@mendable/n8n-nodes-firecrawl.firecrawl","typeVersion":1,"position":[240,2224],"id":"8e5490d1-aae5-4b4c-9e5d-2ee9fe3a26b6","name":"Scrape list page and get content2","credentials":{"firecrawlApi":{"id":"Hm7biHGOu4OQpUIC","name":"Firecrawl account"}}},{"parameters":{"promptType":"define","text":"=Read the below markdown and extract ALL team names and their URLs.\n\n{{ $json.data.markdown }}\n\nIMPORTANT: Extract EVERY team you find. Output should be in JSON array format:\n[\n{\n   \"name\" : \"team_name_here\",\n   \"url\" : \"full_url_here\"\n}\n]","hasOutputParser":true,"options":{}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":3,"position":[448,2240],"id":"dfb34245-28e4-4ab0-aff5-a255877a4ab2","name":"AI Agent - Teams List Extractor3"},{"parameters":{"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[1056,2272],"id":"50f35d5b-4818-4fbf-9898-bfb2c5b24f37","name":"Loop Over Items3","alwaysOutputData":false},{"parameters":{"operation":"scrape","url":"={{ $json.url }}","requestOptions":{}},"type":"@mendable/n8n-nodes-firecrawl.firecrawl","typeVersion":1,"position":[1360,2016],"id":"369487a6-90b6-423d-8e0b-4babed6f8946","name":"Scrape team profile and get details3","credentials":{"firecrawlApi":{"id":"Hm7biHGOu4OQpUIC","name":"Firecrawl account"}}},{"parameters":{"jsonSchemaExample":"[\n{\n   \"name\" : \"name_here\",\n   \"url\" : \"url_here\"\n}\n]"},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.3,"position":[592,2448],"id":"48e20a8b-c18d-4a8d-8d38-c4df31ffc460","name":"Structured Output Parser3"},{"parameters":{"promptType":"define","text":"={{ $json.data.markdown }}\n\nRead above markdown and extract all team details. Return output in JSON format:\n\n{\n\"team_name\" : \"team_name_here\",\n\"website\" : \"website\",\n\"description\" : \"description\",\n\"firstname\" : \"firstname\",\n\"lastname\" : \"lastname\",\n\"email\" : \"emailaddress\",\n\"contact\" : \"contact number\",\n\"location\" :\"location\",\n\"facebook\" : \"facebook page url\",\n\"instagram\" : \"instagram url\",\n\"twitter\" : \"twitter url\"\n}\n\nIf any field is not available, use empty string \"\".","hasOutputParser":true,"options":{}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":3,"position":[1600,1968],"id":"69c4dd5d-ffe2-4564-a7cd-0a44947fb83a","name":"AI Agent - Get team details3"},{"parameters":{"jsonSchemaExample":"{\n\"team_name\" : \"team_name_here\",\n\"website\" : \"website\",\n\"description\" : \"description\",\n\"firstname\" : \"firstname\",\n\"lastname\" : \"lastname\",\n\"email\" : \"emailaddress\",\n\"contact\" : \"contact number\",\n\"location\" :\"location\",\n\"facebook\" : \"facebook page url\",\n\"instagram\" : \"instagram url\",\n\"twitter\" : \"twitter url\"\n}","autoFix":true},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.3,"position":[1664,2208],"id":"540feaa7-61c0-4a5c-a3a5-2b8903f12979","name":"Output Helper3"},{"parameters":{"operation":"append","documentId":{"__rl":true,"value":"101Y3Pl-yh7h4ArxLNh9DH-1e4IUsWKg9xskkmaPh-4I","mode":"list","cachedResultName":"Data-scraping-apify","cachedResultUrl":"https://docs.google.com/spreadsheets/d/101Y3Pl-yh7h4ArxLNh9DH-1e4IUsWKg9xskkmaPh-4I/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":1247602635,"mode":"list","cachedResultName":"Sheet4","cachedResultUrl":"https://docs.google.com/spreadsheets/d/101Y3Pl-yh7h4ArxLNh9DH-1e4IUsWKg9xskkmaPh-4I/edit#gid=1247602635"},"columns":{"mappingMode":"defineBelow","value":{"Team Name":"={{ $json.output.team_name }}","Website":"={{ $json.output.website }}","Contact":"={{ $json.output.contact }}","Lastname":"={{ $json.output.lastname }}","Firstname":"={{ $json.output.firstname }}","Email":"={{ $json.output.email }}","Facebook":"={{ $json.output.facebook }}","Instagram":"={{ $json.output.instagram }}","Twitter":"={{ $json.output.twitter }}","Description":"={{ $json.output.description }}","Location":"={{ $json.output.location }}"},"matchingColumns":[],"schema":[{"id":"Team Name","displayName":"Team Name","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Firstname","displayName":"Firstname","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Lastname","displayName":"Lastname","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Email","displayName":"Email","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Contact","displayName":"Contact","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Location","displayName":"Location","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"Website","displayName":"Website","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Facebook","displayName":"Facebook","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Instagram","displayName":"Instagram","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Twitter","displayName":"Twitter","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Description","displayName":"Description","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.googleSheets","typeVersion":4.7,"position":[2208,2272],"id":"c67186ce-9f2a-4ce8-8149-0a30b73b9ff7","name":"Append row in sheet3","credentials":{"googleSheetsOAuth2Api":{"id":"Rb8zubR3AtNAnBYU","name":"Google Sheets account 3"}}},{"parameters":{"modelName":"models/gemini-2.0-flash","options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatGoogleGemini","typeVersion":1,"position":[448,2448],"id":"473a7452-e90f-4c7d-9345-57a9d3137637","name":"Google Gemini Chat Model9","credentials":{"googlePalmApi":{"id":"2dYCQEJmlRAbJ0ZK","name":"edwin-gemini-api-key"}}},{"parameters":{"modelName":"models/gemini-2.0-flash","options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatGoogleGemini","typeVersion":1,"position":[1472,2240],"id":"8199cddf-64a8-4688-a78c-336f607830d1","name":"Google Gemini Chat Model10","credentials":{"googlePalmApi":{"id":"2dYCQEJmlRAbJ0ZK","name":"edwin-gemini-api-key"}}},{"parameters":{"modelName":"models/gemini-2.0-flash","options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatGoogleGemini","typeVersion":1,"position":[1664,2336],"id":"39b320e3-7a13-4690-8aac-23759119099c","name":"Google Gemini Chat Model11","credentials":{"googlePalmApi":{"id":"2dYCQEJmlRAbJ0ZK","name":"edwin-gemini-api-key"}}},{"parameters":{"operation":"scrape","url":"https://baseballconnected.com/baseball-teams/","requestOptions":{}},"type":"@mendable/n8n-nodes-firecrawl.firecrawl","typeVersion":1,"position":[3648,2352],"id":"4aa0a32f-a3f8-41fa-9844-054b3dbdaaf8","name":"Scrape Page 1","credentials":{"firecrawlApi":{"id":"Hm7biHGOu4OQpUIC","name":"Firecrawl account"}}},{"parameters":{"operation":"scrape","url":"https://baseballconnected.com/baseball-teams/","requestOptions":{}},"type":"@mendable/n8n-nodes-firecrawl.firecrawl","typeVersion":1,"position":[3648,2544],"id":"7430a437-84b0-42c1-b84e-ccf1dad2d049","name":"Scrape Page 2","credentials":{"firecrawlApi":{"id":"Hm7biHGOu4OQpUIC","name":"Firecrawl account"}}},{"parameters":{"operation":"scrape","url":"https://baseballconnected.com/baseball-teams/","requestOptions":{}},"type":"@mendable/n8n-nodes-firecrawl.firecrawl","typeVersion":1,"position":[3648,2736],"id":"61134f83-2245-45dd-878c-951f5908ab02","name":"Scrape Page 3","credentials":{"firecrawlApi":{"id":"Hm7biHGOu4OQpUIC","name":"Firecrawl account"}}},{"parameters":{"operation":"scrape","url":"https://baseballconnected.com/baseball-teams/","requestOptions":{}},"type":"@mendable/n8n-nodes-firecrawl.firecrawl","typeVersion":1,"position":[3648,2944],"id":"1b201c46-ba04-40ff-b3e1-8187f43dfb57","name":"Scrape Page 4","credentials":{"firecrawlApi":{"id":"Hm7biHGOu4OQpUIC","name":"Firecrawl account"}}},{"parameters":{"operation":"scrape","url":"https://baseballconnected.com/baseball-teams/","requestOptions":{}},"type":"@mendable/n8n-nodes-firecrawl.firecrawl","typeVersion":1,"position":[3648,3136],"id":"f3a4bab5-222f-4bd2-aec2-dbd6ce241f3b","name":"Scrape Page 5","credentials":{"firecrawlApi":{"id":"Hm7biHGOu4OQpUIC","name":"Firecrawl account"}}},{"parameters":{},"type":"n8n-nodes-base.merge","typeVersion":3,"position":[3904,2576],"id":"1d2c50ad-e24b-4bc7-8d5e-d5d7451c4dd1","name":"Merge All Pages"},{"parameters":{"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[4112,2576],"id":"c4e0f169-9b1f-4862-b2df-c14bae45f80e","name":"Split Pages (loop pages)3","alwaysOutputData":false},{"parameters":{"promptType":"define","text":"=Read the below markdown and extract ALL team names and their URLs.\n\n{{ $json.data.markdown }}\n\nIMPORTANT: Extract EVERY team you find. Output should be in JSON array format:\n[\n{\n   \"name\" : \"team_name_here\",\n   \"url\" : \"full_url_here\"\n}\n]","hasOutputParser":true,"options":{}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":3,"position":[4384,2560],"id":"35e84e65-8b23-4ffc-bd28-734660eaaa13","name":"AI Agent - Teams List Extractor4"},{"parameters":{"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[5040,2592],"id":"b4225ea6-6598-4b62-9b51-bb451cf9ec16","name":"Loop Over Items4","alwaysOutputData":false},{"parameters":{"operation":"scrape","url":"={{ $json.url }}","requestOptions":{}},"type":"@mendable/n8n-nodes-firecrawl.firecrawl","typeVersion":1,"position":[5344,2336],"id":"b6a45f37-433f-4be0-9108-e3f42474a8c4","name":"Scrape team profile and get details4","credentials":{"firecrawlApi":{"id":"Hm7biHGOu4OQpUIC","name":"Firecrawl account"}}},{"parameters":{"jsonSchemaExample":"[\n{\n   \"name\" : \"name_here\",\n   \"url\" : \"url_here\"\n}\n]"},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.3,"position":[4528,2768],"id":"8eb675e7-0ed7-47ca-86c1-7835368a51d2","name":"Structured Output Parser4"},{"parameters":{"jsCode":"return $input.first().json.output"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[4784,2592],"id":"3ba4b3fc-79ba-4fa0-88be-49e88e874903","name":"Extract Teams Array1"},{"parameters":{"promptType":"define","text":"={{ $json.data.markdown }}\n\nRead above markdown and extract all team details. Return output in JSON format:\n\n{\n\"team_name\" : \"team_name_here\",\n\"website\" : \"website\",\n\"description\" : \"description\",\n\"firstname\" : \"firstname\",\n\"lastname\" : \"lastname\",\n\"email\" : \"emailaddress\",\n\"contact\" : \"contact number\",\n\"location\" :\"location\",\n\"facebook\" : \"facebook page url\",\n\"instagram\" : \"instagram url\",\n\"twitter\" : \"twitter url\"\n}\n\nIf any field is not available, use empty string \"\".","hasOutputParser":true,"options":{}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":3,"position":[5584,2288],"id":"8aaf784e-fd02-452e-bfc6-0ea9991a11d7","name":"AI Agent - Get team details4"},{"parameters":{"jsonSchemaExample":"{\n\"team_name\" : \"team_name_here\",\n\"website\" : \"website\",\n\"description\" : \"description\",\n\"firstname\" : \"firstname\",\n\"lastname\" : \"lastname\",\n\"email\" : \"emailaddress\",\n\"contact\" : \"contact number\",\n\"location\" :\"location\",\n\"facebook\" : \"facebook page url\",\n\"instagram\" : \"instagram url\",\n\"twitter\" : \"twitter url\"\n}","autoFix":true},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.3,"position":[5648,2528],"id":"8d111360-3967-4726-9453-f6e7c7811890","name":"Output Helper4"},{"parameters":{"operation":"append","documentId":{"__rl":true,"value":"101Y3Pl-yh7h4ArxLNh9DH-1e4IUsWKg9xskkmaPh-4I","mode":"list","cachedResultName":"Data-scraping-apify","cachedResultUrl":"https://docs.google.com/spreadsheets/d/101Y3Pl-yh7h4ArxLNh9DH-1e4IUsWKg9xskkmaPh-4I/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":1247602635,"mode":"list","cachedResultName":"Sheet4","cachedResultUrl":"https://docs.google.com/spreadsheets/d/101Y3Pl-yh7h4ArxLNh9DH-1e4IUsWKg9xskkmaPh-4I/edit#gid=1247602635"},"columns":{"mappingMode":"defineBelow","value":{"Team Name":"={{ $json.output.team_name }}","Website":"={{ $json.output.website }}","Contact":"={{ $json.output.contact }}","Lastname":"={{ $json.output.lastname }}","Firstname":"={{ $json.output.firstname }}","Email":"={{ $json.output.email }}","Facebook":"={{ $json.output.facebook }}","Instagram":"={{ $json.output.instagram }}","Twitter":"={{ $json.output.twitter }}","Description":"={{ $json.output.description }}","Location":"={{ $json.output.location }}"},"matchingColumns":[],"schema":[{"id":"Team Name","displayName":"Team Name","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Firstname","displayName":"Firstname","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Lastname","displayName":"Lastname","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Email","displayName":"Email","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Contact","displayName":"Contact","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Location","displayName":"Location","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"Website","displayName":"Website","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Facebook","displayName":"Facebook","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Instagram","displayName":"Instagram","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Twitter","displayName":"Twitter","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Description","displayName":"Description","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.googleSheets","typeVersion":4.7,"position":[6192,2592],"id":"8e0dcbb2-b8ea-4ccd-aa32-6d895d495c14","name":"Append row in sheet4","credentials":{"googleSheetsOAuth2Api":{"id":"Rb8zubR3AtNAnBYU","name":"Google Sheets account 3"}}},{"parameters":{"modelName":"models/gemini-2.0-flash","options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatGoogleGemini","typeVersion":1,"position":[4384,2768],"id":"7f7b9c69-9ee6-40e0-bf99-2a3e5fbe9ccf","name":"Google Gemini Chat Model12","credentials":{"googlePalmApi":{"id":"2dYCQEJmlRAbJ0ZK","name":"edwin-gemini-api-key"}}},{"parameters":{"modelName":"models/gemini-2.0-flash","options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatGoogleGemini","typeVersion":1,"position":[5456,2560],"id":"effa2480-dc57-4f91-ae41-09b423b11062","name":"Google Gemini Chat Model13","credentials":{"googlePalmApi":{"id":"2dYCQEJmlRAbJ0ZK","name":"edwin-gemini-api-key"}}},{"parameters":{"modelName":"models/gemini-2.0-flash","options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatGoogleGemini","typeVersion":1,"position":[5648,2656],"id":"9220975d-4bc8-43c9-ad4a-96018bb90a8c","name":"Google Gemini Chat Model14","credentials":{"googlePalmApi":{"id":"2dYCQEJmlRAbJ0ZK","name":"edwin-gemini-api-key"}}},{"parameters":{"operation":"Run actor and get dataset","actorId":{"__rl":true,"value":"MpRbnNmVAoj5RC1Ma","mode":"list","cachedResultName":"Playwright Scraper (apify/playwright-scraper)","cachedResultUrl":"https://console.apify.com/actors/MpRbnNmVAoj5RC1Ma/input"},"customBody":"{\n  \"maxPagesPerCrawl\": 25,\n  \"browserLog\": false,\n  \"closeCookieModals\": false,\n  \"debugLog\": false,\n  \"downloadCss\": true,\n  \"downloadMedia\": true,\n  \"excludes\": [\n    {\n      \"glob\": \"/**/*.{png,jpg,jpeg,pdf,svg,webp}\"\n    }\n  ],\n  \"globs\": [\n    {\n      \"glob\": \"https://baseballconnected.com/**\"\n    }\n  ],\n  \"headless\": true,\n  \"ignoreCorsAndCsp\": false,\n  \"ignoreSslErrors\": false,\n  \"keepUrlFragments\": false,\n  \"launcher\": \"chromium\",\n  \"linkSelector\": \"a[href]\",\n  \"maxDepth\": 1,\n  \"proxyConfiguration\": {\n    \"useApifyProxy\": true\n  },\n  \"respectRobotsTxtFile\": true,\n  \"startUrls\": [\n    {\n      \"url\": \"https://baseballconnected.com/baseball-teams/\"\n    }\n  ],\n  \"useChrome\": false,\n  \"waitUntil\": \"networkidle\",\n  \"pageFunction\": \"async function pageFunction(context) {\\n    const { page, request, enqueueLinks, log } = context;\\n    const url = request.url;\\n    const title = await page.title();\\n    const text = await page.evaluate(() => document.body.innerText || '');\\n\\n    // safer regex creation using RegExp constructor\\n    let pseudoRegex;\\n    try {\\n        pseudoRegex = new RegExp('team\\\\\\\\b|teams\\\\\\\\b|-baseball|baseball-team', 'i');\\n    } catch (e) {\\n        pseudoRegex = /team\\\\b|teams\\\\b|-baseball|baseball-team/i;\\n    }\\n\\n    try {\\n        const anchors = await page.$$eval('a[href]', els => els.map(a => a.href));\\n        const teamLinks = Array.from(new Set(anchors.filter(h => {\\n            try { return h && h.startsWith('https://baseballconnected.com') && pseudoRegex.test(h); } catch (e) { return false; }\\n        })));\\n        if (teamLinks.length) await enqueueLinks({ urls: teamLinks, label: 'TEAM' });\\n    } catch (e) {}\\n\\n    // simplified team detection\\n    let isTeamPage = false;\\n    try {\\n        const lowUrl = (url || '').toLowerCase();\\n        if (lowUrl.includes('/team') || lowUrl.includes('-baseball') || lowUrl.includes('baseball-team')) {\\n            isTeamPage = true;\\n        } else {\\n            const el = await page.$('article, .team, .team-profile, .profile, .team-details');\\n            if (el) isTeamPage = true;\\n        }\\n    } catch (e) {}\\n\\n    const result = {\\n        \\\"Team Name\\\": null,\\n        \\\"City\\\": null,\\n        \\\"State\\\": null,\\n        \\\"Contact Name\\\": null,\\n        \\\"Email\\\": null,\\n        \\\"Phone\\\": null,\\n        \\\"Website\\\": null,\\n        \\\"Age Groups\\\": null,\\n        \\\"Facebook\\\": null,\\n        \\\"Twitter\\\": null,\\n        \\\"Instagram\\\": null,\\n        \\\"Description\\\": null,\\n        \\\"URL\\\": url,\\n        \\\"_type\\\": isTeamPage ? 'team' : 'listing',\\n        \\\"title\\\": title\\n    };\\n\\n    if (!isTeamPage) {\\n        // return normalized shape for listing pages (fields will be null)\\n        return result;\\n    }\\n\\n    // Team page extraction\\n    try { result[\\\"Team Name\\\"] = await page.$eval('h1', el => el.innerText.trim()); } catch (e) {}\\n    if (!result[\\\"Team Name\\\"]) try { result[\\\"Team Name\\\"] = await page.$eval('.team-title, .entry-title, .profile-title, .page-title', el => el.innerText.trim()); } catch (e) {}\\n\\n    try {\\n        const mailtos = await page.$$eval('a[href^=\\\"mailto:\\\"]', els => els.map(a => a.href.replace(/^mailto:/i, '').split('?')[0].trim()));\\n        if (mailtos.length) result[\\\"Email\\\"] = Array.from(new Set(mailtos)).join('; ');\\n    } catch (e) {}\\n\\n    try {\\n        const tels = await page.$$eval('a[href^=\\\"tel:\\\"]', els => els.map(a => a.href.replace(/^tel:/i, '').trim()));\\n        if (tels.length) result[\\\"Phone\\\"] = Array.from(new Set(tels)).join('; ');\\n    } catch (e) {}\\n    if (!result[\\\"Phone\\\"]) {\\n        try {\\n            const phoneMatches = (text.match(/(?:\\\\+?\\\\d{1,3}[\\\\s.-]?)?(?:\\\\(?\\\\d{2,4}\\\\)?[\\\\s.-]?)?\\\\d{3,4}[\\\\s.-]?\\\\d{3,4}/g) || []);\\n            if (phoneMatches.length) result[\\\"Phone\\\"] = Array.from(new Set(phoneMatches)).join('; ');\\n        } catch (e) {}\\n    }\\n\\n    try {\\n        const external = await page.$$eval('a[href]', els => els.map(a => a.href).filter(h => h && !h.includes('baseballconnected.com')));\\n        if (external.length) {\\n            const website = external.find(h => !/facebook|instagram|twitter|mailto|tel/i.test(h));\\n            result[\\\"Website\\\"] = website || external[0];\\n        }\\n    } catch (e) {}\\n\\n    try {\\n        const socials = await page.$$eval('a[href]', els => els.map(a => a.href));\\n        for (const s of socials) {\\n            try { if (/facebook\\\\.com/i.test(s) && !result[\\\"Facebook\\\"]) result[\\\"Facebook\\\"] = s; } catch (e) {}\\n            try { if (/twitter\\\\.com/i.test(s) && !result[\\\"Twitter\\\"]) result[\\\"Twitter\\\"] = s; } catch (e) {}\\n            try { if (/instagram\\\\.com/i.test(s) && !result[\\\"Instagram\\\"]) result[\\\"Instagram\\\"] = s; } catch (e) {}\\n        }\\n    } catch (e) {}\\n\\n    try {\\n        const contactSelectors = ['.contact-name', '.team-contact h3', '.team-contact', '.contact', '.coach-name', '.contact-person'];\\n        for (const sel of contactSelectors) {\\n            try { const v = await page.$eval(sel, el => el.innerText.trim()); if (v) { result[\\\"Contact Name\\\"] = v; break; } } catch (e) {}\\n        }\\n        if (!result[\\\"Contact Name\\\"]) {\\n            try {\\n                const m = text.match(/Contact[:\\\\s]*([A-Z][a-zA-Z'\\\\-]+(?:\\\\s+[A-Z][a-zA-Z'\\\\-]+){0,3})/i);\\n                if (m) result[\\\"Contact Name\\\"] = m[1];\\n            } catch (e) {}\\n        }\\n    } catch (e) {}\\n\\n    try {\\n        const locSelectors = ['.location', '.team-location', '.team-meta .location', '.address', '.city-state'];\\n        for (const sel of locSelectors) {\\n            try {\\n                const v = await page.$eval(sel, el => el.innerText.trim());\\n                const m = v.match(/([^,\\\\n]+)\\\\s*,\\\\s*([A-Za-z]{2,}|[A-Za-z\\\\s]+)/);\\n                if (m) { result[\\\"City\\\"] = m[1].trim(); result[\\\"State\\\"] = m[2].trim(); break; }\\n            } catch (e) {}\\n        }\\n    } catch (e) {}\\n\\n    try {\\n        const ageMatches = Array.from(new Set((text.match(/\\\\b(?:[6-9]U|1[0-8]U)\\\\b/g) || [])));\\n        if (ageMatches.length) result[\\\"Age Groups\\\"] = ageMatches.join(', ');\\n    } catch (e) {}\\n\\n    try {\\n        const descSel = ['.entry-content p', '.team-description', '.profile-description', '.content p'];\\n        for (const sel of descSel) {\\n            try { const v = await page.$eval(sel, el => el.innerText.trim()); if (v && v.length > 20) { result[\\\"Description\\\"] = v; break; } } catch (e) {}\\n        }\\n        if (!result[\\\"Description\\\"]) result[\\\"Description\\\"] = text.substring(0, 400).trim();\\n    } catch (e) {}\\n\\n    return result;\\n}\\n\",\n  \"pseudoUrls\": [],\n  \"proxyRotation\": \"RECOMMENDED\",\n  \"initialCookies\": [],\n  \"maxRequestRetries\": 3,\n  \"maxResultsPerCrawl\": 0,\n  \"maxCrawlingDepth\": 0,\n  \"maxConcurrency\": 50,\n  \"pageLoadTimeoutSecs\": 60,\n  \"pageFunctionTimeoutSecs\": 60,\n  \"maxScrollHeightPixels\": 5000,\n  \"customData\": {}\n}\n"},"type":"@apify/n8n-nodes-apify.apify","typeVersion":1,"position":[-592,2528],"id":"8ec800ff-cbf9-4402-b87d-95fa34a64534","name":"Run an Actor and get dataset","credentials":{"apifyApi":{"id":"yN37yrPA1ePXOJTp","name":"Apify account"}}}],"connections":{"When clicking ‘Execute workflow’":{"main":[[{"node":"Initial Scrape - Get First Page","type":"main","index":0}]]},"Scrape a url and get its content":{"main":[[{"node":"AI Agent - Teams List Extractor","type":"main","index":0}]]},"AI Agent - Teams List Extractor":{"main":[[{"node":"Code in JavaScript","type":"main","index":0}]]},"Loop Over Items":{"main":[[],[{"node":"Scrape team profile and get details","type":"main","index":0}]]},"Scrape team profile and get details":{"main":[[{"node":"AI Agent - Get team details","type":"main","index":0}]]},"Structured Output Parser":{"ai_outputParser":[[{"node":"AI Agent - Teams List Extractor","type":"ai_outputParser","index":0}]]},"Code in JavaScript":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"AI Agent - Get team details":{"main":[[{"node":"Append row in sheet","type":"main","index":0}]]},"Output Helper":{"ai_outputParser":[[{"node":"AI Agent - Get team details","type":"ai_outputParser","index":0}]]},"Append row in sheet":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Google Gemini Chat Model":{"ai_languageModel":[[{"node":"AI Agent - Teams List Extractor","type":"ai_languageModel","index":0}]]},"Google Gemini Chat Model1":{"ai_languageModel":[[{"node":"AI Agent - Get team details","type":"ai_languageModel","index":0}]]},"Google Gemini Chat Model2":{"ai_languageModel":[[{"node":"Output Helper","type":"ai_languageModel","index":0}]]},"Pagination Code (generate page URLs)":{"main":[[{"node":"Split Pages (loop pages)","type":"main","index":0}]]},"Split Pages (loop pages)":{"main":[[],[{"node":"Scrape list page and get content","type":"main","index":0}]]},"Scrape list page and get content":{"main":[[{"node":"AI Agent - Teams List Extractor1","type":"main","index":0}]]},"Scrape a url and get its content1":{"main":[[]]},"AI Agent - Teams List Extractor1":{"main":[[{"node":"Code in JavaScript2","type":"main","index":0}]]},"Loop Over Items1":{"main":[[],[{"node":"Scrape team profile and get details1","type":"main","index":0}]]},"Scrape team profile and get details1":{"main":[[{"node":"AI Agent - Get team details1","type":"main","index":0}]]},"Structured Output Parser1":{"ai_outputParser":[[{"node":"AI Agent - Teams List Extractor1","type":"ai_outputParser","index":0}]]},"Code in JavaScript2":{"main":[[{"node":"Loop Over Items1","type":"main","index":0}]]},"AI Agent - Get team details1":{"main":[[{"node":"Append row in sheet1","type":"main","index":0}]]},"Output Helper1":{"ai_outputParser":[[{"node":"AI Agent - Get team details1","type":"ai_outputParser","index":0}]]},"Append row in sheet1":{"main":[[{"node":"Loop Over Items1","type":"main","index":0}]]},"Google Gemini Chat Model3":{"ai_languageModel":[[{"node":"AI Agent - Teams List Extractor1","type":"ai_languageModel","index":0}]]},"Google Gemini Chat Model4":{"ai_languageModel":[[{"node":"AI Agent - Get team details1","type":"ai_languageModel","index":0}]]},"Google Gemini Chat Model5":{"ai_languageModel":[[{"node":"Output Helper1","type":"ai_languageModel","index":0}]]},"Scrape a url and get its content2":{"main":[[{"node":"Pagination Code (generate page URLs)1","type":"main","index":0}]]},"Pagination Code (generate page URLs)1":{"main":[[{"node":"Split Pages (loop pages)1","type":"main","index":0}]]},"Split Pages (loop pages)1":{"main":[[{"node":"Scrape list page and get content1","type":"main","index":0}]]},"Scrape list page and get content1":{"main":[[{"node":"AI Agent - Teams List Extractor2","type":"main","index":0}]]},"AI Agent - Teams List Extractor2":{"main":[[{"node":"Code in JavaScript3","type":"main","index":0}]]},"Loop Over Items2":{"main":[[],[{"node":"Scrape team profile and get details2","type":"main","index":0}]]},"Scrape team profile and get details2":{"main":[[{"node":"AI Agent - Get team details2","type":"main","index":0}]]},"Structured Output Parser2":{"ai_outputParser":[[{"node":"AI Agent - Teams List Extractor2","type":"ai_outputParser","index":0}]]},"Code in JavaScript3":{"main":[[{"node":"Loop Over Items2","type":"main","index":0}]]},"AI Agent - Get team details2":{"main":[[{"node":"Append row in sheet2","type":"main","index":0}]]},"Output Helper2":{"ai_outputParser":[[{"node":"AI Agent - Get team details2","type":"ai_outputParser","index":0}]]},"Append row in sheet2":{"main":[[{"node":"Loop Over Items2","type":"main","index":0}]]},"Google Gemini Chat Model6":{"ai_languageModel":[[{"node":"AI Agent - Teams List Extractor2","type":"ai_languageModel","index":0}]]},"Google Gemini Chat Model7":{"ai_languageModel":[[{"node":"AI Agent - Get team details2","type":"ai_languageModel","index":0}]]},"Google Gemini Chat Model8":{"ai_languageModel":[[{"node":"Output Helper2","type":"ai_languageModel","index":0}]]},"Crawl Baseball Teams Pages":{"main":[[{"node":"Pagination Code (generate page URLs)","type":"main","index":0}]]},"Initial Scrape - Get First Page":{"main":[[{"node":"Generate Page URLs","type":"main","index":0}]]},"Generate Page URLs":{"main":[[{"node":"Split Pages (loop pages)2","type":"main","index":0}]]},"Extract Teams Array":{"main":[[{"node":"Loop Over Items3","type":"main","index":0}]]},"Split Pages (loop pages)2":{"main":[[],[{"node":"Scrape list page and get content2","type":"main","index":0}]]},"Scrape list page and get content2":{"main":[[{"node":"AI Agent - Teams List Extractor3","type":"main","index":0}]]},"AI Agent - Teams List Extractor3":{"main":[[{"node":"Extract Teams Array","type":"main","index":0}]]},"Loop Over Items3":{"main":[[],[{"node":"Scrape team profile and get details3","type":"main","index":0}]]},"Scrape team profile and get details3":{"main":[[{"node":"AI Agent - Get team details3","type":"main","index":0}]]},"Structured Output Parser3":{"ai_outputParser":[[{"node":"AI Agent - Teams List Extractor3","type":"ai_outputParser","index":0}]]},"AI Agent - Get team details3":{"main":[[{"node":"Append row in sheet3","type":"main","index":0}]]},"Output Helper3":{"ai_outputParser":[[{"node":"AI Agent - Get team details3","type":"ai_outputParser","index":0}]]},"Append row in sheet3":{"main":[[{"node":"Loop Over Items3","type":"main","index":0}]]},"Google Gemini Chat Model9":{"ai_languageModel":[[{"node":"AI Agent - Teams List Extractor3","type":"ai_languageModel","index":0}]]},"Google Gemini Chat Model10":{"ai_languageModel":[[{"node":"AI Agent - Get team details3","type":"ai_languageModel","index":0}]]},"Google Gemini Chat Model11":{"ai_languageModel":[[{"node":"Output Helper3","type":"ai_languageModel","index":0}]]},"Scrape Page 1":{"main":[[{"node":"Merge All Pages","type":"main","index":0}]]},"Scrape Page 2":{"main":[[{"node":"Merge All Pages","type":"main","index":1}]]},"Scrape Page 3":{"main":[[{"node":"Merge All Pages","type":"main","index":1}]]},"Scrape Page 4":{"main":[[{"node":"Merge All Pages","type":"main","index":1}]]},"Scrape Page 5":{"main":[[{"node":"Merge All Pages","type":"main","index":1}]]},"Merge All Pages":{"main":[[{"node":"Split Pages (loop pages)3","type":"main","index":0}]]},"Split Pages (loop pages)3":{"main":[[{"node":"Split Pages (loop pages)3","type":"main","index":0}],[{"node":"AI Agent - Teams List Extractor4","type":"main","index":0}]]},"AI Agent - Teams List Extractor4":{"main":[[{"node":"Extract Teams Array1","type":"main","index":0}]]},"Loop Over Items4":{"main":[[{"node":"Loop Over Items4","type":"main","index":0}],[{"node":"Scrape team profile and get details4","type":"main","index":0}]]},"Scrape team profile and get details4":{"main":[[{"node":"AI Agent - Get team details4","type":"main","index":0}]]},"Structured Output Parser4":{"ai_outputParser":[[{"node":"AI Agent - Teams List Extractor4","type":"ai_outputParser","index":0}]]},"Extract Teams Array1":{"main":[[{"node":"Loop Over Items4","type":"main","index":0}]]},"AI Agent - Get team details4":{"main":[[{"node":"Append row in sheet4","type":"main","index":0}]]},"Output Helper4":{"ai_outputParser":[[{"node":"AI Agent - Get team details4","type":"ai_outputParser","index":0}]]},"Append row in sheet4":{"main":[[{"node":"Loop Over Items4","type":"main","index":0}]]},"Google Gemini Chat Model12":{"ai_languageModel":[[{"node":"AI Agent - Teams List Extractor4","type":"ai_languageModel","index":0}]]},"Google Gemini Chat Model13":{"ai_languageModel":[[{"node":"AI Agent - Get team details4","type":"ai_languageModel","index":0}]]},"Google Gemini Chat Model14":{"ai_languageModel":[[{"node":"Output Helper4","type":"ai_languageModel","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":null,"pinData":{},"versionId":"15295351-0c0a-43a1-b5b4-73df30445e3f","triggerCount":0,"shared":[{"updatedAt":"2025-11-21T07:27:09.852Z","createdAt":"2025-11-21T07:27:09.852Z","role":"workflow:owner","workflowId":"EjBOvLhLOTbvAeJo","projectId":"tsuA2t8C154Ytetn"}],"tags":[]}