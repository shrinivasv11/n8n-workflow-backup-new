{"updatedAt":"2025-11-21T11:39:04.433Z","createdAt":"2025-11-21T10:28:14.572Z","id":"3HYpHk92FwTDubjT","name":"Website Scraping - Firecrawl-shrinivas2","active":false,"isArchived":false,"nodes":[{"parameters":{"operation":"Run actor and get dataset","actorId":{"__rl":true,"value":"MpRbnNmVAoj5RC1Ma","mode":"list","cachedResultName":"Playwright Scraper (apify/playwright-scraper)","cachedResultUrl":"https://console.apify.com/actors/MpRbnNmVAoj5RC1Ma/input"},"customBody":"{\n  \"maxPagesPerCrawl\": 25,\n  \"browserLog\": false,\n  \"closeCookieModals\": false,\n  \"debugLog\": false,\n  \"downloadCss\": true,\n  \"downloadMedia\": true,\n  \"excludes\": [\n    {\n      \"glob\": \"/**/*.{png,jpg,jpeg,pdf,svg,webp}\"\n    }\n  ],\n  \"globs\": [\n    {\n      \"glob\": \"https://baseballconnected.com/**\"\n    }\n  ],\n  \"headless\": true,\n  \"ignoreCorsAndCsp\": false,\n  \"ignoreSslErrors\": false,\n  \"keepUrlFragments\": false,\n  \"launcher\": \"chromium\",\n  \"linkSelector\": \"a[href]\",\n  \"maxDepth\": 1,\n  \"proxyConfiguration\": {\n    \"useApifyProxy\": true\n  },\n  \"respectRobotsTxtFile\": true,\n  \"startUrls\": [\n    {\n      \"url\": \"https://baseballconnected.com/baseball-teams/\"\n    }\n  ],\n  \"useChrome\": false,\n  \"waitUntil\": \"networkidle\",\n  \"pageFunction\": \"async function pageFunction(context) {\\n    const { page, request, enqueueLinks, log } = context;\\n    const url = request.url;\\n    const title = await page.title();\\n    const text = await page.evaluate(() => document.body.innerText || '');\\n\\n    // safer regex creation using RegExp constructor\\n    let pseudoRegex;\\n    try {\\n        pseudoRegex = new RegExp('team\\\\\\\\b|teams\\\\\\\\b|-baseball|baseball-team', 'i');\\n    } catch (e) {\\n        pseudoRegex = /team\\\\b|teams\\\\b|-baseball|baseball-team/i;\\n    }\\n\\n    try {\\n        const anchors = await page.$$eval('a[href]', els => els.map(a => a.href));\\n        const teamLinks = Array.from(new Set(anchors.filter(h => {\\n            try { return h && h.startsWith('https://baseballconnected.com') && pseudoRegex.test(h); } catch (e) { return false; }\\n        })));\\n        if (teamLinks.length) await enqueueLinks({ urls: teamLinks, label: 'TEAM' });\\n    } catch (e) {}\\n\\n    // simplified team detection\\n    let isTeamPage = false;\\n    try {\\n        const lowUrl = (url || '').toLowerCase();\\n        if (lowUrl.includes('/team') || lowUrl.includes('-baseball') || lowUrl.includes('baseball-team')) {\\n            isTeamPage = true;\\n        } else {\\n            const el = await page.$('article, .team, .team-profile, .profile, .team-details');\\n            if (el) isTeamPage = true;\\n        }\\n    } catch (e) {}\\n\\n    const result = {\\n        \\\"Team Name\\\": null,\\n        \\\"City\\\": null,\\n        \\\"State\\\": null,\\n        \\\"Contact Name\\\": null,\\n        \\\"Email\\\": null,\\n        \\\"Phone\\\": null,\\n        \\\"Website\\\": null,\\n        \\\"Age Groups\\\": null,\\n        \\\"Facebook\\\": null,\\n        \\\"Twitter\\\": null,\\n        \\\"Instagram\\\": null,\\n        \\\"Description\\\": null,\\n        \\\"URL\\\": url,\\n        \\\"_type\\\": isTeamPage ? 'team' : 'listing',\\n        \\\"title\\\": title\\n    };\\n\\n    if (!isTeamPage) {\\n        // return normalized shape for listing pages (fields will be null)\\n        return result;\\n    }\\n\\n    // Team page extraction\\n    try { result[\\\"Team Name\\\"] = await page.$eval('h1', el => el.innerText.trim()); } catch (e) {}\\n    if (!result[\\\"Team Name\\\"]) try { result[\\\"Team Name\\\"] = await page.$eval('.team-title, .entry-title, .profile-title, .page-title', el => el.innerText.trim()); } catch (e) {}\\n\\n    try {\\n        const mailtos = await page.$$eval('a[href^=\\\"mailto:\\\"]', els => els.map(a => a.href.replace(/^mailto:/i, '').split('?')[0].trim()));\\n        if (mailtos.length) result[\\\"Email\\\"] = Array.from(new Set(mailtos)).join('; ');\\n    } catch (e) {}\\n\\n    try {\\n        const tels = await page.$$eval('a[href^=\\\"tel:\\\"]', els => els.map(a => a.href.replace(/^tel:/i, '').trim()));\\n        if (tels.length) result[\\\"Phone\\\"] = Array.from(new Set(tels)).join('; ');\\n    } catch (e) {}\\n    if (!result[\\\"Phone\\\"]) {\\n        try {\\n            const phoneMatches = (text.match(/(?:\\\\+?\\\\d{1,3}[\\\\s.-]?)?(?:\\\\(?\\\\d{2,4}\\\\)?[\\\\s.-]?)?\\\\d{3,4}[\\\\s.-]?\\\\d{3,4}/g) || []);\\n            if (phoneMatches.length) result[\\\"Phone\\\"] = Array.from(new Set(phoneMatches)).join('; ');\\n        } catch (e) {}\\n    }\\n\\n    try {\\n        const external = await page.$$eval('a[href]', els => els.map(a => a.href).filter(h => h && !h.includes('baseballconnected.com')));\\n        if (external.length) {\\n            const website = external.find(h => !/facebook|instagram|twitter|mailto|tel/i.test(h));\\n            result[\\\"Website\\\"] = website || external[0];\\n        }\\n    } catch (e) {}\\n\\n    try {\\n        const socials = await page.$$eval('a[href]', els => els.map(a => a.href));\\n        for (const s of socials) {\\n            try { if (/facebook\\\\.com/i.test(s) && !result[\\\"Facebook\\\"]) result[\\\"Facebook\\\"] = s; } catch (e) {}\\n            try { if (/twitter\\\\.com/i.test(s) && !result[\\\"Twitter\\\"]) result[\\\"Twitter\\\"] = s; } catch (e) {}\\n            try { if (/instagram\\\\.com/i.test(s) && !result[\\\"Instagram\\\"]) result[\\\"Instagram\\\"] = s; } catch (e) {}\\n        }\\n    } catch (e) {}\\n\\n    try {\\n        const contactSelectors = ['.contact-name', '.team-contact h3', '.team-contact', '.contact', '.coach-name', '.contact-person'];\\n        for (const sel of contactSelectors) {\\n            try { const v = await page.$eval(sel, el => el.innerText.trim()); if (v) { result[\\\"Contact Name\\\"] = v; break; } } catch (e) {}\\n        }\\n        if (!result[\\\"Contact Name\\\"]) {\\n            try {\\n                const m = text.match(/Contact[:\\\\s]*([A-Z][a-zA-Z'\\\\-]+(?:\\\\s+[A-Z][a-zA-Z'\\\\-]+){0,3})/i);\\n                if (m) result[\\\"Contact Name\\\"] = m[1];\\n            } catch (e) {}\\n        }\\n    } catch (e) {}\\n\\n    try {\\n        const locSelectors = ['.location', '.team-location', '.team-meta .location', '.address', '.city-state'];\\n        for (const sel of locSelectors) {\\n            try {\\n                const v = await page.$eval(sel, el => el.innerText.trim());\\n                const m = v.match(/([^,\\\\n]+)\\\\s*,\\\\s*([A-Za-z]{2,}|[A-Za-z\\\\s]+)/);\\n                if (m) { result[\\\"City\\\"] = m[1].trim(); result[\\\"State\\\"] = m[2].trim(); break; }\\n            } catch (e) {}\\n        }\\n    } catch (e) {}\\n\\n    try {\\n        const ageMatches = Array.from(new Set((text.match(/\\\\b(?:[6-9]U|1[0-8]U)\\\\b/g) || [])));\\n        if (ageMatches.length) result[\\\"Age Groups\\\"] = ageMatches.join(', ');\\n    } catch (e) {}\\n\\n    try {\\n        const descSel = ['.entry-content p', '.team-description', '.profile-description', '.content p'];\\n        for (const sel of descSel) {\\n            try { const v = await page.$eval(sel, el => el.innerText.trim()); if (v && v.length > 20) { result[\\\"Description\\\"] = v; break; } } catch (e) {}\\n        }\\n        if (!result[\\\"Description\\\"]) result[\\\"Description\\\"] = text.substring(0, 400).trim();\\n    } catch (e) {}\\n\\n    return result;\\n}\\n\",\n  \"pseudoUrls\": [],\n  \"proxyRotation\": \"RECOMMENDED\",\n  \"initialCookies\": [],\n  \"maxRequestRetries\": 3,\n  \"maxResultsPerCrawl\": 0,\n  \"maxCrawlingDepth\": 0,\n  \"maxConcurrency\": 50,\n  \"pageLoadTimeoutSecs\": 60,\n  \"pageFunctionTimeoutSecs\": 60,\n  \"maxScrollHeightPixels\": 5000,\n  \"customData\": {}\n}\n","timeout":{}},"type":"@apify/n8n-nodes-apify.apify","typeVersion":1,"position":[-208,16],"id":"2fd4aec6-a5da-46d3-9b6f-fde1c512e24e","name":"Run an Actor and get dataset","credentials":{"apifyApi":{"id":"yN37yrPA1ePXOJTp","name":"Apify account"}}},{"parameters":{},"type":"n8n-nodes-base.manualTrigger","typeVersion":1,"position":[128,-160],"id":"f9f7edb1-2403-4e26-b613-71db6d0a2d78","name":"When clicking ‘Execute workflow’"},{"parameters":{"operation":"scrape","url":"https://baseballconnected.com/baseball-teams/","parsers":["pdf"],"requestOptions":{}},"type":"@mendable/n8n-nodes-firecrawl.firecrawl","typeVersion":1,"position":[192,-480],"id":"1dced0e9-ec78-4eb8-a7a1-289db13d4347","name":"Scrape a url and get its content","credentials":{"firecrawlApi":{"id":"Hm7biHGOu4OQpUIC","name":"Firecrawl account"}}},{"parameters":{"modelName":"models/gemini-2.0-flash","options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatGoogleGemini","typeVersion":1,"position":[496,64],"id":"206b556d-5e22-474a-be17-85f486e22a1a","name":"Gemini 2.0 flash","credentials":{"googlePalmApi":{"id":"77KLSHM0nlw0viYq","name":"shubham-gemini-api-key"}}},{"parameters":{"promptType":"define","text":"=Read the below input and give the names and their link from it.\n{{  $input.item.json.toJsonString() }}\n\nit should be in JSON format As below : \n[\n{\n   \"name\" : \"name_here\",\n   \"url\" : \"url_here\"\n}\n]\n\nIf getting error or something wrog skip that record.\nGenerate/parse only 27 records.","hasOutputParser":true,"options":{}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":3,"position":[592,-192],"id":"a3c4b2b0-b799-4b94-9603-443f4db6c4cc","name":"AI Agent - Teams List Extractor"},{"parameters":{"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[1216,-192],"id":"f92df419-dcf3-479b-bb66-ba3874a5f2f0","name":"Loop Over Items","alwaysOutputData":false},{"parameters":{"operation":"scrape","url":"={{ $json.url }}","parsers":["pdf"],"requestOptions":{}},"type":"@mendable/n8n-nodes-firecrawl.firecrawl","typeVersion":1,"position":[1536,-176],"id":"36db3632-4f25-4e55-918d-bc1bcef1a7b7","name":"Scrape team profile and get details","credentials":{"firecrawlApi":{"id":"Hm7biHGOu4OQpUIC","name":"Firecrawl account"}}},{"parameters":{"jsonSchemaExample":"[\n{\n   \"name\" : \"name_here\",\n   \"url\" : \"url_here\"\n}\n]","autoFix":true},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.3,"position":[688,48],"id":"8d059e4e-86a9-404c-86d4-069e734b29ec","name":"Structured Output Parser"},{"parameters":{"jsCode":"return $input.first().json.output"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[960,-192],"id":"9d9aaa05-ee8e-47d9-9c24-1bd209dae712","name":"Code in JavaScript"},{"parameters":{"promptType":"define","text":"={{ $json.data.markdown }}\n\nread above markdown and return me output in JSON like below\n\n{\n\"team_name\" : \"team_name_here\",\n\"website\" : \"website\",\n\"description\" : \"description\",\n\"firstname\" : \"firstname\",\n\"lastname\" : \"lastname\",\n\"email\" : \"emailaddress\",\n\"contact\" : \"contact number\",\n\"location\" :\"location\",\n\"facebook\" : \"facebook page url\",\n\"instagram\" : \"instagram url\",\n\"twitter\" : \"twitter url\"\n}","hasOutputParser":true,"options":{}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":3,"position":[1760,-176],"id":"58376e16-5d03-4ce7-af9c-152a3a430309","name":"AI Agent - Get team details"},{"parameters":{"modelName":"models/gemini-2.0-flash","options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatGoogleGemini","typeVersion":1,"position":[1760,-32],"id":"307a9136-73df-4494-a657-8c8da4f24d46","name":"Google Gemini 2.0 Flash","credentials":{"googlePalmApi":{"id":"2dYCQEJmlRAbJ0ZK","name":"edwin-gemini-api-key"}}},{"parameters":{"jsonSchemaExample":"{\n\"team_name\" : \"team_name_here\",\n\"website\" : \"website\",\n\"description\" : \"description\",\n\"firstname\" : \"firstname\",\n\"lastname\" : \"lastname\",\n\"email\" : \"emailaddress\",\n\"contact\" : \"contact number\",\n\"location\" :\"location\",\n\"facebook\" : \"facebook page url\",\n\"instagram\" : \"instagram url\",\n\"twitter\" : \"twitter url\"\n}","autoFix":true},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.3,"position":[1824,64],"id":"3a34283a-3f26-4aa2-9f10-d11d314c01fb","name":"Output Helper"},{"parameters":{"operation":"append","documentId":{"__rl":true,"value":"101Y3Pl-yh7h4ArxLNh9DH-1e4IUsWKg9xskkmaPh-4I","mode":"list","cachedResultName":"Data-scraping-apify","cachedResultUrl":"https://docs.google.com/spreadsheets/d/101Y3Pl-yh7h4ArxLNh9DH-1e4IUsWKg9xskkmaPh-4I/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":1247602635,"mode":"list","cachedResultName":"Sheet4","cachedResultUrl":"https://docs.google.com/spreadsheets/d/101Y3Pl-yh7h4ArxLNh9DH-1e4IUsWKg9xskkmaPh-4I/edit#gid=1247602635"},"columns":{"mappingMode":"defineBelow","value":{"Team Name":"={{ $json.output.team_name }}","Website":"={{ $json.output.website }}","Contact":"={{ $json.output.contact }}","Lastname":"={{ $json.output.lastname }}","Firstname":"={{ $json.output.firstname }}","Email":"={{ $json.output.email }}","Facebook":"={{ $json.output.facebook }}","Instagram":"={{ $json.output.instagram }}","Twitter":"={{ $json.output.twitter }}","Description":"={{ $json.output.description }}","Location":"={{ $json.output.location }}"},"matchingColumns":[],"schema":[{"id":"Team Name","displayName":"Team Name","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Firstname","displayName":"Firstname","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Lastname","displayName":"Lastname","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Email","displayName":"Email","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Contact","displayName":"Contact","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Location","displayName":"Location","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"Website","displayName":"Website","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Facebook","displayName":"Facebook","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Instagram","displayName":"Instagram","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Twitter","displayName":"Twitter","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Description","displayName":"Description","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.googleSheets","typeVersion":4.7,"position":[2368,128],"id":"ae6c4f26-da23-473d-930f-9efa65c9f9a3","name":"Append row in sheet","credentials":{"googleSheetsOAuth2Api":{"id":"Rb8zubR3AtNAnBYU","name":"Google Sheets account 3"}}},{"parameters":{"modelName":"models/gemini-2.0-flash","options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatGoogleGemini","typeVersion":1,"position":[1824,192],"id":"d7999cac-fde9-44f7-b428-950b72235144","name":"Format fixer","credentials":{"googlePalmApi":{"id":"2dYCQEJmlRAbJ0ZK","name":"edwin-gemini-api-key"}}},{"parameters":{"operation":"Run actor and get dataset","actorId":{"__rl":true,"value":"MpRbnNmVAoj5RC1Ma","mode":"list","cachedResultName":"Playwright Scraper (apify/playwright-scraper)","cachedResultUrl":"https://console.apify.com/actors/MpRbnNmVAoj5RC1Ma/input"},"customBody":"{ \"maxRequestsPerCrawl\": 25, \"browserLog\": false, \"closeCookieModals\": false, \"debugLog\": false, \"downloadCss\": true, \"downloadMedia\": true, \"excludes\": [ { \"glob\": \"/**/*.{png,jpg,jpeg,pdf,svg,webp}\" } ], \"globs\": [ { \"glob\": \"https://baseballconnected.com/**\" } ], \"headless\": true, \"ignoreCorsAndCsp\": false, \"ignoreSslErrors\": false, \"keepUrlFragments\": false, \"launcher\": \"chromium\", \"linkSelector\": \"a[href]\", \"maxDepth\": 1, \"proxyConfiguration\": { \"useApifyProxy\": true }, \"respectRobotsTxtFile\": true, \"startUrls\": [ { \"url\": \"https://baseballconnected.com/baseball-teams/\" } ], \"useChrome\": false, \"waitUntil\": \"networkidle\", \"pageFunction\": \"async function pageFunction(context) { const { page, request, enqueueLinks, log } = context; const url = request.url; const title = await page.title(); // Helper: normalize text const text = await page.evaluate(() => document.body.innerText || ''); // Enqueue links that look like team detail pages try { const pseudoRegex = /\\\\/team\\\\b|\\\\/teams\\\\b|-baseball|\\\\/baseball-team/i; const anchors = await page.$$eval('a[href]', els => els.map(a => a.href)); const teamLinks = Array.from(new Set(anchors.filter(h => { try { return h && h.startsWith('https://baseballconnected.com') && pseudoRegex.test(h); } catch (e) { return false; } }))); if (teamLinks.length) { await enqueueLinks({ urls: teamLinks, label: 'TEAM' }); } } catch (e) {} const isTeamPage = /\\\\/team\\\\b|-baseball|\\\\/team\\\\//i.test(url) || (await page.$('article, .team, .team-profile, .profile, .team-details')) !== null; if (!isTeamPage) { return { _type: 'listing', url, title }; } // ==== TEAM DETAIL EXTRACTION const result = { teamName: null, city: null, state: null, contactName: null, email: null, phone: null, website: null, ageGroups: null, facebook: null, twitter: null, instagram: null, description: null, url }; // Team name try { result.teamName = await page.$eval('h1', el => el.innerText.trim()); } catch (e) {} if (!result.teamName) { try { result.teamName = await page.$eval('.team-title, .entry-title, .profile-title, .page-title', el => el.innerText.trim()); } catch (e) {} } // Email try { const mailtos = await page.$$eval('a[href^=\\\"mailto:\\\"]', els => els.map(a => a.href.replace(/^mailto:/i, '').split('?')[0].trim())); if (mailtos.length) result.email = Array.from(new Set(mailtos)).join('; '); } catch (e) {} // Phone try { const tels = await page.$$eval('a[href^=\\\"tel:\\\"]', els => els.map(a => a.href.replace(/^tel:/i, '').trim())); if (tels.length) result.phone = Array.from(new Set(tels)).join('; '); } catch (e) {} if (!result.phone) { const phoneMatches = (text.match(/(?:\\\\+?\\\\d{1,3}[\\\\s.-]?)?(?:\\\\(?\\\\d{2,4}\\\\)?[\\\\s.-]?)?\\\\d{3,4}[\\\\s.-]?\\\\d{3,4}/g) || []); if (phoneMatches.length) result.phone = Array.from(new Set(phoneMatches)).join('; '); } // External website try { const external = await page.$$eval('a[href]', els => els.map(a => a.href).filter(h => h && !h.includes('baseballconnected.com')) ); if (external.length) { const website = external.find(h => !/facebook|instagram|twitter|mailto|tel/i.test(h)); result.website = website || external[0]; } } catch (e) {} // Socials try { const socials = await page.$$eval('a[href]', els => els.map(a => a.href)); for (const s of socials) { if (/facebook\\\\.com/i.test(s)) result.facebook ||= s; if (/twitter\\\\.com/i.test(s)) result.twitter ||= s; if (/instagram\\\\.com/i.test(s)) result.instagram ||= s; } } catch (e) {} // Contact name try { const contactSelectors = [ '.contact-name', '.team-contact h3', '.team-contact', '.contact', '.coach-name', '.contact-person' ]; for (const sel of contactSelectors) { try { const v = await page.$eval(sel, el => el.innerText.trim()); if (v) { result.contactName = v; break; } } catch (e) {} } if (!result.contactName) { const m = text.match(/Contact[:\\\\s]*([A-Z][a-zA-Z'\\\\-]+(?:\\\\s+[A-Z][a-zA-Z'\\\\-]+){0,3})/i); if (m) result.contactName = m[1]; } } catch (e) {} // City / State try { const locSelectors = ['.location', '.team-location', '.team-meta .location', '.address', '.city-state']; for (const sel of locSelectors) { try { const v = await page.$eval(sel, el => el.innerText.trim()); const m = v.match(/([^,\\\\n]+)\\\\s*,\\\\s*([A-Za-z]{2,}|[A-Za-z\\\\s]+)/); if (m) { result.city = m[1].trim(); result.state = m[2].trim(); break; } } catch (e) {} } } catch (e) {} // Age groups try { const ageMatches = Array.from(new Set((text.match(/\\\\b(?:[6-9]U|1[0-8]U)\\\\b/g) || []))); if (ageMatches.length) result.ageGroups = ageMatches.join(', '); } catch (e) {} // Description try { const descSel = ['.entry-content p', '.team-description', '.profile-description', '.content p']; for (const sel of descSel) { try { const v = await page.$eval(sel, el => el.innerText.trim()); if (v && v.length > 20) { result.description = v; break; } } catch (e) {} } if (!result.description) result.description = text.substring(0, 400).trim(); } catch (e) {} // Push LIVE to dataset await Apify.pushData({ TeamName: result.teamName, City: result.city, State: result.state, ContactName: result.contactName, Email: result.email, Phone: result.phone, Website: result.website, AgeGroups: result.ageGroups, Facebook: result.facebook, Twitter: result.twitter, Instagram: result.instagram, Description: result.description, URL: result.url, _timestamp: new Date().toISOString() }); // Log live log.info('SCRAPED TEAM: ' + JSON.stringify(result)); // Return for final dataset return { TeamName: result.teamName, City: result.city, State: result.state, ContactName: result.contactName, Email: result.email, Phone: result.phone, Website: result.website, AgeGroups: result.ageGroups, Facebook: result.facebook, Twitter: result.twitter, Instagram: result.instagram, Description: result.description, URL: result.url }; }\" } "},"type":"@apify/n8n-nodes-apify.apify","typeVersion":1,"position":[976,-464],"id":"6dd88105-cc9d-4e18-90bd-49155c57039b","name":"Run an Actor and get dataset1","credentials":{"apifyApi":{"id":"yN37yrPA1ePXOJTp","name":"Apify account"}}},{"parameters":{"operation":"Run actor and get dataset","actorId":{"__rl":true,"value":"MpRbnNmVAoj5RC1Ma","mode":"list","cachedResultName":"Playwright Scraper (apify/playwright-scraper)","cachedResultUrl":"https://console.apify.com/actors/MpRbnNmVAoj5RC1Ma/input"},"customBody":"{\n  \"maxRequestsPerCrawl\": 25,\n    \"browserLog\": false,\n    \"closeCookieModals\": false,\n    \"debugLog\": false,\n    \"downloadCss\": true,\n    \"downloadMedia\": true,\n    \"excludes\": [\n        {\n            \"glob\": \"/**/*.{png,jpg,jpeg,pdf}\"\n        }\n    ],\n    \"headless\": true,\n    \"ignoreCorsAndCsp\": false,\n    \"ignoreSslErrors\": false,\n    \"keepUrlFragments\": false,\n    \"launcher\": \"chromium\",\n    \"linkSelector\": \"a\",\n    \"maxCrawlingDepth\": 1,\n    \"maxRequestRetries\": 0,\n    \"pageFunction\": \"async function pageFunction(context) {\\n    const { page, request, log } = context;\\n    const title = await page.title();\\n    log.info(`URL: ${request.url} TITLE: ${title}`);\\n    return {\\n        url: request.url,\\n        title\\n    };\\n}\",\n    \"pageFunctionTimeoutSecs\": 11,\n    \"pageLoadTimeoutSecs\": 60,\n    \"postNavigationHooks\": \"// We need to return array of (possibly async) functions here.\\n// The functions accept a single argument: the \\\"crawlingContext\\\" object.\\n[\\n    async (crawlingContext) => {\\n        const { page } = crawlingContext;\\n        // ...\\n    },\\n]\",\n    \"preNavigationHooks\": \"// We need to return array of (possibly async) functions here.\\n// The functions accept two arguments: the \\\"crawlingContext\\\" object\\n// and \\\"gotoOptions\\\".\\n[\\n    async (crawlingContext, gotoOptions) => {\\n        const { page } = crawlingContext;\\n        // ...\\n    },\\n]\",\n    \"proxyConfiguration\": {\n        \"useApifyProxy\": true\n    },\n    \"respectRobotsTxtFile\": true,\n    \"startUrls\": [\n        {\n            \"url\": \"https://baseballconnected.com/baseball-teams/\"\n        }\n    ],\n    \"useChrome\": false,\n    \"waitUntil\": \"networkidle\",\n  \"globs\": [\n  {\n    \"glob\": \"https://baseballconnected.com/baseball-teams/**\"\n  }\n]\n}"},"type":"@apify/n8n-nodes-apify.apify","typeVersion":1,"position":[352,-160],"id":"36994e62-4a11-4386-8a65-8bab781b203c","name":"Run an Actor and get dataset2","credentials":{"apifyApi":{"id":"yN37yrPA1ePXOJTp","name":"Apify account"}}},{"parameters":{"modelName":"models/gemini-2.0-flash","options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatGoogleGemini","typeVersion":1,"position":[704,272],"id":"cff2027e-0b59-4c5e-a930-fd577c866165","name":"Google Gemini Chat Model","credentials":{"googlePalmApi":{"id":"2dYCQEJmlRAbJ0ZK","name":"edwin-gemini-api-key"}}}],"connections":{"When clicking ‘Execute workflow’":{"main":[[{"node":"Run an Actor and get dataset2","type":"main","index":0}]]},"Scrape a url and get its content":{"main":[[]]},"Gemini 2.0 flash":{"ai_languageModel":[[{"node":"AI Agent - Teams List Extractor","type":"ai_languageModel","index":0}]]},"AI Agent - Teams List Extractor":{"main":[[{"node":"Code in JavaScript","type":"main","index":0}]]},"Loop Over Items":{"main":[[],[{"node":"Scrape team profile and get details","type":"main","index":0}]]},"Scrape team profile and get details":{"main":[[{"node":"AI Agent - Get team details","type":"main","index":0}]]},"Structured Output Parser":{"ai_outputParser":[[{"node":"AI Agent - Teams List Extractor","type":"ai_outputParser","index":0}]]},"Code in JavaScript":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"AI Agent - Get team details":{"main":[[{"node":"Append row in sheet","type":"main","index":0}]]},"Google Gemini 2.0 Flash":{"ai_languageModel":[[{"node":"AI Agent - Get team details","type":"ai_languageModel","index":0}]]},"Output Helper":{"ai_outputParser":[[{"node":"AI Agent - Get team details","type":"ai_outputParser","index":0}]]},"Append row in sheet":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Format fixer":{"ai_languageModel":[[{"node":"Output Helper","type":"ai_languageModel","index":0}]]},"Run an Actor and get dataset2":{"main":[[{"node":"AI Agent - Teams List Extractor","type":"main","index":0}]]},"Google Gemini Chat Model":{"ai_languageModel":[[{"node":"Structured Output Parser","type":"ai_languageModel","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"5715180f-ae7d-48c4-b3d1-ed17a8be203d","triggerCount":0,"shared":[{"updatedAt":"2025-11-21T10:28:14.572Z","createdAt":"2025-11-21T10:28:14.572Z","role":"workflow:owner","workflowId":"3HYpHk92FwTDubjT","projectId":"tsuA2t8C154Ytetn"}],"tags":[]}